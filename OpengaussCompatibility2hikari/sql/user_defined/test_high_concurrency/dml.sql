INSERT INTO tpcds.warehouse_t16 VALUES (1, 'WH000001', 'Warehouse 1', 10000, '123', 'Main St', 'Ave', 'Suite100', 'New York', 'New York', 'NY', '10001', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (2, 'WH000002', 'Warehouse 2', 12000, '456', 'Broadway', 'Blvd', 'Suite200', 'Chicago', 'Cook', 'IL', '60601', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (3, 'WH000003', 'Warehouse 3', 15000, '789', 'Market St', 'St', 'Suite300', 'San Francisco', 'San Francisco', 'CA', '94101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (4, 'WH000004', 'Warehouse 4', 14000, '101', 'Elm St', 'Rd', 'Suite400', 'Houston', 'Harris', 'TX', '77001', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (5, 'WH000005', 'Warehouse 5', 16000, '202', 'Pine St', 'Ln', 'Suite500', 'Miami', 'Miami-Dade', 'FL', '33101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (6, 'WH000006', 'Warehouse 6', 18000, '303', 'Oak St', 'Dr', 'Suite600', 'Seattle', 'King', 'WA', '98101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (7, 'WH000007', 'Warehouse 7', 20000, '404', 'Maple St', 'Blvd', 'Suite700', 'Boston', 'Suffolk', 'MA', '02101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (8, 'WH000008', 'Warehouse 8', 25000, '303', 'Oak St', 'Blvd', 'Suite600', 'Los Angeles', 'Los Angeles', 'CA', '90001', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (9, 'WH000009', 'Warehouse 9', 22000, '505', 'Cedar St', 'Ave', 'Suite800', 'San Diego', 'San Diego', 'CA', '92101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (10, 'WH000010', 'Warehouse 10', 24000, '606', 'Birch St', 'St', 'Suite900', 'Dallas', 'Dallas', 'TX', '75201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t1 VALUES (33, 'WH000033', 'Warehouse 33', 51000, '487', 'Rose St', 'Ave', 'Suite231', 'Redlands', 'San Bernardino', 'CA', '92373', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (11, 'WH000011', 'Warehouse 11', 26000, '707', 'Fir St', 'Rd', 'Suite1000', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (12, 'WH000012', 'Warehouse 12', 28000, '808', 'Spruce St', 'Ln', 'Suite1100', 'Atlanta', 'Fulton', 'GA', '30301', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (13, 'WH000013', 'Warehouse 13', 30000, '909', 'Ash St', 'Blvd', 'Suite1200', 'Orlando', 'Orange', 'FL', '32801', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (14, 'WH000014', 'Warehouse 14', 32000, '1010', 'Hickory St', 'Ave', 'Suite1300', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (15, 'WH000015', 'Warehouse 15', 34000, '1111', 'Willow St', 'St', 'Suite1400', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (16, 'WH000016', 'Warehouse 16', 36000, '1212', 'Redwood St', 'Rd', 'Suite1500', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (17, 'WH000017', 'Warehouse 17', 38000, '1313', 'Cypress St', 'Ln', 'Suite1600', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (18, 'WH000018', 'Warehouse 18', 40000, '1414', 'Juniper St', 'Blvd', 'Suite1700', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (19, 'WH000019', 'Warehouse 19', 42000, '1515', 'Magnolia St', 'Ave', 'Suite1800', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (20, 'WH000020', 'Warehouse 20', 44000, '1616', 'Sequoia St', 'St', 'Suite1900', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (21, 'WH000021', 'Warehouse 21', 46000, '1717', 'Poplar St', 'Rd', 'Suite2000', 'Austin', 'Travis', 'TX', '73301', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (22, 'WH000022', 'Warehouse 22', 48000, '1818', 'Dogwood St', 'Ln', 'Suite2100', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (23, 'WH000023', 'Warehouse 23', 50000, '1919', 'Maplewood St', 'Blvd', 'Suite2200', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (24, 'WH000024', 'Warehouse 24', 52000, '2020', 'Aspen St', 'Ave', 'Suite2300', 'Indianapolis', 'Marion', 'IN', '46201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (25, 'WH000025', 'Warehouse 25', 54000, '2121', 'Chestnut St', 'St', 'Suite2400', 'Fort Worth', 'Tarrant', 'TX', '76101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (26, 'WH000026', 'Warehouse 26', 56000, '2222', 'Beech St', 'Rd', 'Suite2500', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (27, 'WH000027', 'Warehouse 27', 58000, '2323', 'Sycamore St', 'Ln', 'Suite2600', 'San Francisco', 'San Francisco', 'CA', '94103', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (28, 'WH000028', 'Warehouse 28', 60000, '2424', 'Cedarwood St', 'Blvd', 'Suite2700', 'Nashville', 'Davidson', 'TN', '37201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (29, 'WH000029', 'Warehouse 29', 62000, '2525', 'Cherry St', 'Ave', 'Suite2800', 'Oklahoma City', 'Oklahoma', 'OK', '73101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (30, 'WH000030', 'Warehouse 30', 64000, '2626', 'Walnut St', 'St', 'Suite2900', 'Memphis', 'Shelby', 'TN', '37501', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (31, 'WH000031', 'Warehouse 31', 66000, '2727', 'Chestnut St', 'Rd', 'Suite3000', 'Louisville', 'Jefferson', 'KY', '40201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (32, 'WH000032', 'Warehouse 32', 68000, '2828', 'Maple St', 'Ln', 'Suite3100', 'Baltimore', 'Baltimore', 'MD', '21201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (33, 'WH000033', 'Warehouse 33', 70000, '2929', 'Elm St', 'Blvd', 'Suite3200', 'Milwaukee', 'Milwaukee', 'WI', '53201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (34, 'WH000034', 'Warehouse 34', 72000, '3030', 'Pine St', 'Ave', 'Suite3300', 'Albuquerque', 'Bernalillo', 'NM', '87101', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (35, 'WH000035', 'Warehouse 35', 74000, '3131', 'Cypress St', 'St', 'Suite3400', 'Kansas City', 'Jackson', 'MO', '64101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (36, 'WH000036', 'Warehouse 36', 76000, '3232', 'Fir St', 'Rd', 'Suite3500', 'Sacramento', 'Sacramento', 'CA', '94203', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (37, 'WH000037', 'Warehouse 37', 78000, '3333', 'Oak St', 'Ln', 'Suite3600', 'Raleigh', 'Wake', 'NC', '27601', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (38, 'WH000038', 'Warehouse 38', 80000, '3434', 'Birch St', 'Blvd', 'Suite3700', 'Miami', 'Miami-Dade', 'FL', '33101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (39, 'WH000039', 'Warehouse 39', 82000, '3535', 'Redwood St', 'Ave', 'Suite3800', 'Tulsa', 'Tulsa', 'OK', '74101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (40, 'WH000040', 'Warehouse 40', 84000, '3636', 'Maplewood St', 'St', 'Suite3900', 'Minneapolis', 'Hennepin', 'MN', '55401', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (41, 'WH000041', 'Warehouse 41', 86000, '3737', 'Sycamore St', 'Rd', 'Suite4000', 'Colorado Springs', 'El Paso', 'CO', '80901', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (42, 'WH000042', 'Warehouse 42', 88000, '3838', 'Willow St', 'Ln', 'Suite4100', 'Honolulu', 'Honolulu', 'HI', '96801', 'USA', -10.00);
INSERT INTO tpcds.warehouse_t16 VALUES (43, 'WH000043', 'Warehouse 43', 90000, '3939', 'Juniper St', 'Blvd', 'Suite4200', 'Tucson', 'Pima', 'AZ', '85701', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (44, 'WH000044', 'Warehouse 44', 92000, '4040', 'Ash St', 'Ave', 'Suite4300', 'Mesa', 'Maricopa', 'AZ', '85201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (45, 'WH000045', 'Warehouse 45', 94000, '4141', 'Magnolia St', 'St', 'Suite4400', 'Omaha', 'Douglas', 'NE', '68101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (46, 'WH000046', 'Warehouse 46', 96000, '4242', 'Dogwood St', 'Rd', 'Suite4500', 'Arlington', 'Tarrant', 'TX', '76001', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (47, 'WH000047', 'Warehouse 47', 98000, '4343', 'Poplar St', 'Ln', 'Suite4600', 'Wichita', 'Sedgwick', 'KS', '67201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (48, 'WH000048', 'Warehouse 48', 100000, '4444', 'Aspen St', 'Blvd', 'Suite4700', 'St. Louis', 'St. Louis', 'MO', '63101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (49, 'WH000049', 'Warehouse 49', 102000, '4545', 'Cedarwood St', 'Ave', 'Suite4800', 'New Orleans', 'Orleans', 'LA', '70112', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (50, 'WH000050', 'Warehouse 50', 104000, '4646', 'Chestnut St', 'St', 'Suite4900', 'Cleveland', 'Cuyahoga', 'OH', '44101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (51, 'WH000051', 'Warehouse 51', 106000, '4747', 'Maple St', 'Rd', 'Suite5000', 'Pittsburgh', 'Allegheny', 'PA', '15201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (52, 'WH000052', 'Warehouse 52', 108000, '4848', 'Pine St', 'Ln', 'Suite5100', 'Buffalo', 'Erie', 'NY', '14201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (53, 'WH000053', 'Warehouse 53', 110000, '4949', 'Birch St', 'Blvd', 'Suite5200', 'Minneapolis', 'Hennepin', 'MN', '55401', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (54, 'WH000054', 'Warehouse 54', 112000, '5050', 'Willow St', 'Ave', 'Suite5300', 'Tucson', 'Pima', 'AZ', '85701', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (55, 'WH000055', 'Warehouse 55', 114000, '5151', 'Elm St', 'St', 'Suite5400', 'Omaha', 'Douglas', 'NE', '68101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (56, 'WH000056', 'Warehouse 56', 116000, '5252', 'Maplewood St', 'Rd', 'Suite5500', 'Indianapolis', 'Marion', 'IN', '46201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (57, 'WH000057', 'Warehouse 57', 118000, '5353', 'Cypress St', 'Ln', 'Suite5600', 'Louisville', 'Jefferson', 'KY', '40201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (58, 'WH000058', 'Warehouse 58', 120000, '5454', 'Juniper St', 'Blvd', 'Suite5700', 'Baltimore', 'Baltimore', 'MD', '21201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (59, 'WH000059', 'Warehouse 59', 122000, '5555', 'Redwood St', 'Ave', 'Suite5800', 'Memphis', 'Shelby', 'TN', '37501', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (60, 'WH000060', 'Warehouse 60', 124000, '5656', 'Pine St', 'Blvd', 'Suite5900', 'Milwaukee', 'Milwaukee', 'WI', '53201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (61, 'WH000061', 'Warehouse 61', 126000, '5757', 'Spruce St', 'Ave', 'Suite6000', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (62, 'WH000062', 'Warehouse 62', 128000, '5858', 'Ash St', 'St', 'Suite6100', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (63, 'WH000063', 'Warehouse 63', 130000, '5959', 'Willow St', 'Rd', 'Suite6200', 'Austin', 'Travis', 'TX', '73301', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (64, 'WH000064', 'Warehouse 64', 132000, '6060', 'Magnolia St', 'Ln', 'Suite6300', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (65, 'WH000065', 'Warehouse 65', 134000, '6161', 'Dogwood St', 'Blvd', 'Suite6400', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (66, 'WH000066', 'Warehouse 66', 136000, '6262', 'Cedarwood St', 'Ave', 'Suite6500', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (67, 'WH000067', 'Warehouse 67', 138000, '6363', 'Poplar St', 'St', 'Suite6600', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (68, 'WH000068', 'Warehouse 68', 140000, '6464', 'Chestnut St', 'Rd', 'Suite6700', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (69, 'WH000069', 'Warehouse 69', 142000, '6565', 'Juniper St', 'Ln', 'Suite6800', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (70, 'WH000070', 'Warehouse 70', 144000, '6666', 'Maplewood St', 'Blvd', 'Suite6900', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (71, 'WH000071', 'Warehouse 71', 146000, '6767', 'Cypress St', 'Ave', 'Suite7000', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (72, 'WH000072', 'Warehouse 72', 148000, '6868', 'Redwood St', 'St', 'Suite7100', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (73, 'WH000073', 'Warehouse 73', 150000, '6969', 'Pine St', 'Rd', 'Suite7200', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (74, 'WH000074', 'Warehouse 74', 152000, '7070', 'Willow St', 'Ln', 'Suite7300', 'Tucson', 'Pima', 'AZ', '85701', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (75, 'WH000075', 'Warehouse 75', 154000, '7171', 'Birch St', 'Blvd', 'Suite7400', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (76, 'WH000076', 'Warehouse 76', 156000, '7272', 'Magnolia St', 'Ave', 'Suite7500', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (77, 'WH000077', 'Warehouse 77', 158000, '7373', 'Dogwood St', 'St', 'Suite7600', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (78, 'WH000078', 'Warehouse 78', 160000, '7474', 'Juniper St', 'Rd', 'Suite7700', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (79, 'WH000079', 'Warehouse 79', 162000, '7575', 'Maple St', 'Ln', 'Suite7800', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (80, 'WH000080', 'Warehouse 80', 164000, '7676', 'Cypress St', 'Blvd', 'Suite7900', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (81, 'WH000081', 'Warehouse 81', 166000, '7777', 'Redwood St', 'Ave', 'Suite8000', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (82, 'WH000082', 'Warehouse 82', 168000, '7878', 'Willow St', 'St', 'Suite8100', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (83, 'WH000083', 'Warehouse 83', 170000, '7979', 'Cedarwood St', 'Ln', 'Suite8200', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (84, 'WH000084', 'Warehouse 84', 172000, '8080', 'Poplar St', 'Blvd', 'Suite8300', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (85, 'WH000085', 'Warehouse 85', 174000, '8181', 'Juniper St', 'Ave', 'Suite8400', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (86, 'WH000086', 'Warehouse 86', 176000, '8282', 'Ash St', 'St', 'Suite8500', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (87, 'WH000087', 'Warehouse 87', 178000, '8383', 'Dogwood St', 'Rd', 'Suite8600', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (88, 'WH000088', 'Warehouse 88', 180000, '8484', 'Maplewood St', 'Blvd', 'Suite8700', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (89, 'WH000089', 'Warehouse 89', 182000, '8585', 'Cypress St', 'Ave', 'Suite8800', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (90, 'WH000090', 'Warehouse 90', 184000, '8686', 'Redwood St', 'St', 'Suite8900', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (91, 'WH000091', 'Warehouse 91', 186000, '8787', 'Pine St', 'Ln', 'Suite9000', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (92, 'WH000092', 'Warehouse 92', 188000, '8888', 'Willow St', 'Blvd', 'Suite9100', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (93, 'WH000093', 'Warehouse 93', 190000, '8989', 'Cedarwood St', 'Ave', 'Suite9200', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (94, 'WH000094', 'Warehouse 94', 192000, '9090', 'Juniper St', 'St', 'Suite9300', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (95, 'WH000095', 'Warehouse 95', 194000, '9191', 'Dogwood St', 'Rd', 'Suite9400', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (96, 'WH000096', 'Warehouse 96', 196000, '9292', 'Maplewood St', 'Blvd', 'Suite9500', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (97, 'WH000097', 'Warehouse 97', 198000, '9393', 'Pine St', 'Ave', 'Suite9600', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (98, 'WH000098', 'Warehouse 98', 200000, '9494', 'Redwood St', 'St', 'Suite9700', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (99, 'WH000099', 'Warehouse 99', 202000, '9595', 'Cypress St', 'Rd', 'Suite9800', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (100, 'WH000100', 'Warehouse 100', 204000, '9696', 'Willow St', 'Ln', 'Suite9900', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (101, 'WH000101', 'Warehouse 101', 206000, '9797', 'Maple St', 'Blvd', 'Suite1000', 'Omaha', 'Douglas', 'NE', '68101', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (102, 'WH000102', 'Warehouse 102', 208000, '9898', 'Cedarwood St', 'Ave', 'Suite1100', 'Indianapolis', 'Marion', 'IN', '46201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (103, 'WH000103', 'Warehouse 103', 210000, '9999', 'Pine St', 'St', 'Suite1020', 'Louisville', 'Jefferson', 'KY', '40201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (104, 'WH000104', 'Warehouse 104', 212000, '10000', 'Birch St', 'Ln', 'Suite1030', 'Baltimore', 'Baltimore', 'MD', '21201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (105, 'WH000105', 'Warehouse 105', 214000, '10101', 'Juniper St', 'Blvd', 'Suite1040', 'Memphis', 'Shelby', 'TN', '37501', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (106, 'WH000106', 'Warehouse 106', 216000, '10202', 'Maplewood St', 'Ave', 'Suite1050', 'Milwaukee', 'Milwaukee', 'WI', '53201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (107, 'WH000107', 'Warehouse 107', 218000, '10303', 'Cypress St', 'St', 'Suite1060', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (108, 'WH000108', 'Warehouse 108', 220000, '10404', 'Redwood St', 'Rd', 'Suite1070', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (109, 'WH000109', 'Warehouse 109', 222000, '10505', 'Pine St', 'Ln', 'Suite1080', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (110, 'WH000110', 'Warehouse 110', 224000, '10606', 'Willow St', 'Blvd', 'Suite1090', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (111, 'WH000111', 'Warehouse 111', 226000, '10707', 'Cedarwood St', 'Ave', 'Suite1100', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (112, 'WH000112', 'Warehouse 112', 228000, '10808', 'Maple St', 'St', 'Suite1110', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (113, 'WH000113', 'Warehouse 113', 230000, '10909', 'Juniper St', 'Rd', 'Suite1120', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (114, 'WH000114', 'Warehouse 114', 232000, '11010', 'Birch St', 'Blvd', 'Suite1130', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (115, 'WH000115', 'Warehouse 115', 234000, '11111', 'Willow St', 'Ave', 'Suite1140', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (116, 'WH000116', 'Warehouse 116', 236000, '11212', 'Redwood St', 'St', 'Suite1150', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (117, 'WH000117', 'Warehouse 117', 238000, '11313', 'Pine St', 'Ln', 'Suite1160', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (118, 'WH000118', 'Warehouse 118', 240000, '11414', 'Maplewood St', 'Blvd', 'Suite1170', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (119, 'WH000119', 'Warehouse 119', 242000, '11515', 'Cypress St', 'Ave', 'Suite1180', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (120, 'WH000120', 'Warehouse 120', 244000, '11616', 'Juniper St', 'St', 'Suite1190', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (121, 'WH000121', 'Warehouse 121', 246000, '11717', 'Redwood St', 'Rd', 'Suite1200', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (122, 'WH000122', 'Warehouse 122', 248000, '11818', 'Pine St', 'Ln', 'Suite1210', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (123, 'WH000123', 'Warehouse 123', 250000, '11919', 'Willow St', 'Blvd', 'Suite1220', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (124, 'WH000124', 'Warehouse 124', 252000, '12020', 'Maplewood St', 'Ave', 'Suite1230', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (125, 'WH000125', 'Warehouse 125', 254000, '12121', 'Birch St', 'St', 'Suite1240', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (126, 'WH000126', 'Warehouse 126', 256000, '12222', 'Redwood St', 'Blvd', 'Suite1250', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (127, 'WH000127', 'Warehouse 127', 258000, '12323', 'Pine St', 'Ave', 'Suite1260', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (128, 'WH000128', 'Warehouse 128', 260000, '12424', 'Juniper St', 'St', 'Suite1270', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (129, 'WH000129', 'Warehouse 129', 262000, '12525', 'Maplewood St', 'Blvd', 'Suite1280', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (130, 'WH000130', 'Warehouse 130', 264000, '12626', 'Cypress St', 'Ave', 'Suite1290', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (131, 'WH000131', 'Warehouse 131', 266000, '12727', 'Redwood St', 'St', 'Suite1300', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (132, 'WH000132', 'Warehouse 132', 268000, '12828', 'Willow St', 'Blvd', 'Suite1310', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (133, 'WH000133', 'Warehouse 133', 270000, '12929', 'Pine St', 'Ln', 'Suite1320', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (134, 'WH000134', 'Warehouse 134', 272000, '13030', 'Juniper St', 'Blvd', 'Suite1330', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (135, 'WH000135', 'Warehouse 135', 274000, '13131', 'Maplewood St', 'Ave', 'Suite1340', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (136, 'WH000136', 'Warehouse 136', 276000, '13232', 'Cypress St', 'St', 'Suite1350', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (137, 'WH000137', 'Warehouse 137', 278000, '13333', 'Birch St', 'Blvd', 'Suite1360', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (138, 'WH000138', 'Warehouse 138', 280000, '13434', 'Juniper St', 'Ave', 'Suite1370', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (139, 'WH000139', 'Warehouse 139', 282000, '13535', 'Redwood St', 'St', 'Suite1380', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (140, 'WH000140', 'Warehouse 140', 284000, '13636', 'Pine St', 'Blvd', 'Suite1390', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (141, 'WH000141', 'Warehouse 141', 286000, '13737', 'Maplewood St', 'Ave', 'Suite1400', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (142, 'WH000142', 'Warehouse 142', 288000, '13838', 'Cypress St', 'Blvd', 'Suite1410', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (143, 'WH000143', 'Warehouse 143', 290000, '13939', 'Willow St', 'Ln', 'Suite1420', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (144, 'WH000144', 'Warehouse 144', 292000, '14040', 'Redwood St', 'Blvd', 'Suite1430', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (145, 'WH000145', 'Warehouse 145', 294000, '14141', 'Pine St', 'Ave', 'Suite1440', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (146, 'WH000146', 'Warehouse 146', 296000, '14242', 'Maplewood St', 'Blvd', 'Suite1450', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (147, 'WH000147', 'Warehouse 147', 298000, '14343', 'Juniper St', 'Ave', 'Suite1460', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (148, 'WH000148', 'Warehouse 148', 300000, '14444', 'Cypress St', 'St', 'Suite1470', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (149, 'WH000149', 'Warehouse 149', 302000, '14545', 'Redwood St', 'Blvd', 'Suite1480', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (150, 'WH000150', 'Warehouse 150', 304000, '14646', 'Pine St', 'Ln', 'Suite1490', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (151, 'WH000151', 'Warehouse 151', 306000, '14747', 'Maple St', 'Blvd', 'Suite1500', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (152, 'WH000152', 'Warehouse 152', 308000, '14848', 'Cypress St', 'Ave', 'Suite1510', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (153, 'WH000153', 'Warehouse 153', 310000, '14949', 'Redwood St', 'St', 'Suite1520', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (154, 'WH000154', 'Warehouse 154', 312000, '15050', 'Pine St', 'Ln', 'Suite1530', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (155, 'WH000155', 'Warehouse 155', 314000, '15151', 'Willow St', 'Blvd', 'Suite1540', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (156, 'WH000156', 'Warehouse 156', 316000, '15252', 'Juniper St', 'Ave', 'Suite1550', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (157, 'WH000157', 'Warehouse 157', 318000, '15353', 'Maplewood St', 'Blvd', 'Suite1560', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (158, 'WH000158', 'Warehouse 158', 320000, '15454', 'Cypress St', 'St', 'Suite1570', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (159, 'WH000159', 'Warehouse 159', 322000, '15555', 'Redwood St', 'Blvd', 'Suite1580', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (160, 'WH000160', 'Warehouse 160', 324000, '15656', 'Pine St', 'Ave', 'Suite1590', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (161, 'WH000161', 'Warehouse 161', 326000, '15757', 'Willow St', 'Ln', 'Suite1600', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (162, 'WH000162', 'Warehouse 162', 328000, '15858', 'Maple St', 'Blvd', 'Suite1610', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (163, 'WH000163', 'Warehouse 163', 330000, '15959', 'Cypress St', 'Ave', 'Suite1620', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (164, 'WH000164', 'Warehouse 164', 332000, '16060', 'Redwood St', 'St', 'Suite1630', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (165, 'WH000165', 'Warehouse 165', 334000, '16161', 'Pine St', 'Ln', 'Suite1640', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (166, 'WH000166', 'Warehouse 166', 336000, '16262', 'Willow St', 'Blvd', 'Suite1650', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (167, 'WH000167', 'Warehouse 167', 338000, '16363', 'Juniper St', 'Ave', 'Suite1660', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (168, 'WH000168', 'Warehouse 168', 340000, '16464', 'Maplewood St', 'Blvd', 'Suite1670', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (169, 'WH000169', 'Warehouse 169', 342000, '16565', 'Cypress St', 'St', 'Suite1680', 'Las Vegas', 'Clark', 'NV', '89101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (170, 'WH000170', 'Warehouse 170', 344000, '16666', 'Redwood St', 'Blvd', 'Suite1690', 'Phoenix', 'Maricopa', 'AZ', '85001', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (171, 'WH000171', 'Warehouse 171', 346000, '16767', 'Pine St', 'Ave', 'Suite1700', 'Philadelphia', 'Philadelphia', 'PA', '19101', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (172, 'WH000172', 'Warehouse 172', 348000, '16868', 'Willow St', 'Ln', 'Suite1710', 'Charlotte', 'Mecklenburg', 'NC', '28201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (173, 'WH000173', 'Warehouse 173', 350000, '16969', 'Maple St', 'Blvd', 'Suite1720', 'Columbus', 'Franklin', 'OH', '43201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (174, 'WH000174', 'Warehouse 174', 352000, '17070', 'Cypress St', 'Ave', 'Suite1730', 'San Jose', 'Santa Clara', 'CA', '95101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (175, 'WH000175', 'Warehouse 175', 354000, '17171', 'Redwood St', 'St', 'Suite1740', 'San Antonio', 'Bexar', 'TX', '78201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t16 VALUES (176, 'WH000176', 'Warehouse 176', 356000, '17272', 'Pine St', 'Ln', 'Suite1750', 'Jacksonville', 'Duval', 'FL', '32099', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (177, 'WH000177', 'Warehouse 177', 358000, '17373', 'Willow St', 'Blvd', 'Suite1760', 'Detroit', 'Wayne', 'MI', '48201', 'USA', -5.00);
INSERT INTO tpcds.warehouse_t16 VALUES (178, 'WH000178', 'Warehouse 178', 360000, '17474', 'Juniper St', 'Ave', 'Suite1770', 'Denver', 'Denver', 'CO', '80201', 'USA', -7.00);
INSERT INTO tpcds.warehouse_t16 VALUES (179, 'WH000179', 'Warehouse 179', 362000, '17575', 'Maplewood St', 'Blvd', 'Suite1780', 'Portland', 'Multnomah', 'OR', '97201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t16 VALUES (180, 'WH000180', 'Warehouse 180', 364000, '17676', 'Cypress St', 'St','Suite1790', 'Dallas', 'Dallas', 'TX', '75201', 'USA', -6.00);
INSERT INTO tpcds.warehouse_t1 VALUES (2, 'WH000002', 'Warehouse 2', 20000,'456', 'Broadway', 'Blvd', 'Suite200', 'Los Angeles', 'Los Angeles', 'CA', '90001', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (3, 'WH000003', 'Warehouse 3', 21000, '457', 'Main St', 'Ave', 'Suite201', 'San Francisco', 'San Francisco', 'CA', '94101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (4, 'WH000004', 'Warehouse 4', 22000, '458', 'Elm St', 'St', 'Suite202', 'San Diego', 'San Diego', 'CA', '92101', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (5, 'WH000005', 'Warehouse 5', 23000, '459', 'Pine St', 'Blvd', 'Suite203', 'Sacramento', 'Sacramento', 'CA', '95801', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (6, 'WH000006', 'Warehouse 6', 24000, '460', 'Oak St', 'Ave', 'Suite204', 'Fresno', 'Fresno', 'CA', '93701', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (7, 'WH000007', 'Warehouse 7', 25000, '461', 'Maple St', 'Ln', 'Suite205', 'Long Beach', 'Los Angeles', 'CA', '90801', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (8, 'WH000008', 'Warehouse 8', 26000, '462', 'Cypress St', 'Blvd', 'Suite206', 'Bakersfield', 'Kern', 'CA', '93301', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (9, 'WH000009', 'Warehouse 9', 27000, '463', 'Willow St', 'St', 'Suite207', 'Anaheim', 'Orange', 'CA', '92801', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (10, 'WH000010', 'Warehouse 10', 28000, '464', 'Fir St', 'Ave', 'Suite208', 'Santa Ana', 'Orange', 'CA', '92701', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (11, 'WH000011', 'Warehouse 11', 29000, '465', 'Aspen St', 'Blvd', 'Suite209', 'Riverside', 'Riverside', 'CA', '92501', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (12, 'WH000012', 'Warehouse 12', 30000, '466', 'Spruce St', 'St', 'Suite210', 'Irvine', 'Orange', 'CA', '92601', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (13, 'WH000013', 'Warehouse 13', 31000, '467', 'Cedar St', 'Blvd', 'Suite211', 'Santa Clarita', 'Los Angeles', 'CA', '91301', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (14, 'WH000014', 'Warehouse 14', 32000, '468', 'Birch St', 'Ave', 'Suite212', 'Chula Vista', 'San Diego', 'CA', '91901', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (15, 'WH000015', 'Warehouse 15', 33000, '469', 'Poplar St', 'Ln', 'Suite213', 'Oceanside', 'San Diego', 'CA', '92001', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (16, 'WH000016', 'Warehouse 16', 34000, '470', 'Linden St', 'Blvd', 'Suite214', 'Temecula', 'Riverside', 'CA', '92590', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (17, 'WH000017', 'Warehouse 17', 35000, '471', 'Hemlock St', 'St', 'Suite215', 'Murrieta', 'Riverside', 'CA', '92562', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (18, 'WH000018', 'Warehouse 18', 36000, '472', 'Holly St', 'Ave', 'Suite216', 'Menifee', 'Riverside', 'CA', '92584', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (19, 'WH000019', 'Warehouse 19', 37000, '473', 'Walnut St', 'Blvd', 'Suite217', 'Temecula', 'Riverside', 'CA', '92591', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (20, 'WH000020', 'Warehouse 20', 38000, '474', 'Chestnut St', 'Ln', 'Suite218', 'Palm Springs', 'Riverside', 'CA', '92262', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (21, 'WH000021', 'Warehouse 21', 39000, '475', 'Sycamore St', 'St', 'Suite219', 'La Quinta', 'Riverside', 'CA', '92253', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (22, 'WH000022', 'Warehouse 22', 40000, '476', 'Magnolia St', 'Ave', 'Suite220', 'Cathedral City', 'Riverside', 'CA', '92234', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (23, 'WH000023', 'Warehouse 23', 41000, '477', 'Eucalyptus St', 'Blvd', 'Suite221', 'Coachella', 'Riverside', 'CA', '92236', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (24, 'WH000024', 'Warehouse 24', 42000, '478', 'Acacia St', 'St', 'Suite222', 'Indio', 'Riverside', 'CA', '92201', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (25, 'WH000025', 'Warehouse 25', 43000, '479', 'Palm St', 'Ave', 'Suite223', 'Desert Hot Springs', 'Riverside', 'CA', '92240', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (26, 'WH000026', 'Warehouse 26', 44000, '480', 'Bamboo St', 'Ln', 'Suite224', 'La Quinta', 'Riverside', 'CA', '92253', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (27, 'WH000027', 'Warehouse 27', 45000, '481', 'Olive St', 'Blvd', 'Suite225', 'Indian Wells', 'Riverside', 'CA', '92210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (28, 'WH000028', 'Warehouse 28', 46000, '482', 'Jasmine St', 'St', 'Suite226', 'Rancho Mirage', 'Riverside', 'CA', '92270', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (29, 'WH000029', 'Warehouse 29', 47000, '483', 'Hibiscus St', 'Ave', 'Suite227', 'Palm Desert', 'Riverside', 'CA', '92260', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (30, 'WH000030', 'Warehouse 30', 48000, '484', 'Laurel St', 'Blvd', 'Suite228', 'Twentynine Palms', 'San Bernardino', 'CA', '92277', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (31, 'WH000031', 'Warehouse 31', 49000, '485', 'Lily St', 'Ln', 'Suite229', 'Yucca Valley', 'San Bernardino', 'CA', '92284', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (32, 'WH000032', 'Warehouse 32', 50000, '486', 'Daisy St', 'St', 'Suite230', 'Highland', 'San Bernardino', 'CA', '92346', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (34, 'WH000034', 'Warehouse 34', 52000, '488', 'Sunflower St', 'Blvd', 'Suite232', 'San Bernardino', 'San Bernardino', 'CA', '92401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (35, 'WH000035', 'Warehouse 35', 53000, '489', 'Orchid St', 'Ln', 'Suite233', 'Colton', 'San Bernardino', 'CA', '92324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (36, 'WH000036', 'Warehouse 36', 54000, '490', 'Tulip St', 'St', 'Suite234', 'Fontana', 'San Bernardino', 'CA', '92335', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (37, 'WH000037', 'Warehouse 37', 55000, '491', 'Violet St', 'Ave', 'Suite235', 'Ontario', 'San Bernardino', 'CA', '91761', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (38, 'WH000038', 'Warehouse 38', 56000, '492', 'Marigold St', 'Blvd', 'Suite236', 'Chino', 'San Bernardino', 'CA', '91710', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (39, 'WH000039', 'Warehouse 39', 57000, '493', 'Poppy St', 'Ln', 'Suite237', 'Rancho Cucamonga', 'San Bernardino', 'CA', '91730', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (40, 'WH000040', 'Warehouse 40', 58000, '494', 'Iris St', 'St', 'Suite238', 'Upland', 'San Bernardino', 'CA', '91786', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (41, 'WH000041', 'Warehouse 41', 59000, '495', 'Magnolia St', 'Ave', 'Suite239', 'Pomona', 'Los Angeles', 'CA', '91767', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (42, 'WH000042', 'Warehouse 42', 60000, '496', 'Daffodil St', 'Blvd', 'Suite240', 'La Verne', 'Los Angeles', 'CA', '91750', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (43, 'WH000043', 'Warehouse 43', 61000, '497', 'Carnation St', 'Ln', 'Suite241', 'Claremont', 'Los Angeles', 'CA', '91711', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (44, 'WH000044', 'Warehouse 44', 62000, '498', 'Azalea St', 'St', 'Suite242', 'La Puente', 'Los Angeles', 'CA', '91744', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (45, 'WH000045', 'Warehouse 45', 63000, '499', 'Hibiscus St', 'Ave', 'Suite243', 'West Covina', 'Los Angeles', 'CA', '91790', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (46, 'WH000046', 'Warehouse 46', 64000, '500', 'Hollyhock St', 'Blvd', 'Suite244', 'Montebello', 'Los Angeles', 'CA', '90640', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (47, 'WH000047', 'Warehouse 47', 65000, '501', 'Gardenia St', 'Ln', 'Suite245', 'Norwalk', 'Los Angeles', 'CA', '90650', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (48, 'WH000048', 'Warehouse 48', 66000, '502', 'Jasmine St', 'St', 'Suite246', 'Bellflower', 'Los Angeles', 'CA', '90706', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (49, 'WH000049', 'Warehouse 49', 67000, '503', 'Lily St', 'Ave', 'Suite247', 'South Gate', 'Los Angeles', 'CA', '90280', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (50, 'WH000050', 'Warehouse 50', 68000, '504', 'Lily St', 'Blvd', 'Suite248', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (51, 'WH000051', 'Warehouse 51', 69000, '505', 'Magnolia St', 'Ln', 'Suite249', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (52, 'WH000052', 'Warehouse 52', 70000, '506', 'Rose St', 'St', 'Suite250', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (53, 'WH000053', 'Warehouse 53', 71000, '507', 'Tulip St', 'Ave', 'Suite251', 'Hollywood', 'Los Angeles', 'CA', '90028', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (54, 'WH000054', 'Warehouse 54', 72000, '508', 'Daisy St', 'Blvd', 'Suite252', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (55, 'WH000055', 'Warehouse 55', 73000, '509', 'Sunflower St', 'Ln', 'Suite253', 'Bel Air', 'Los Angeles', 'CA', '90077', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (56, 'WH000056', 'Warehouse 56', 74000, '510', 'Hibiscus St', 'St', 'Suite254', 'Brentwood', 'Los Angeles', 'CA', '90049', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (57, 'WH000057', 'Warehouse 57', 75000, '511', 'Orchid St', 'Ave', 'Suite255', 'Palms', 'Los Angeles', 'CA', '90034', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (58, 'WH000058', 'Warehouse 58', 76000, '512', 'Gardenia St', 'Blvd', 'Suite256', 'Marina del Rey', 'Los Angeles', 'CA', '90292', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (59, 'WH000059', 'Warehouse 59', 77000, '513', 'Lily St', 'Ln', 'Suite257', 'Venice', 'Los Angeles', 'CA', '90291', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (60, 'WH000060', 'Warehouse 60', 78000, '514', 'Azalea St', 'St', 'Suite258', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (61, 'WH000061', 'Warehouse 61', 79000, '515', 'Jasmine St', 'Ave', 'Suite259', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (62, 'WH000062', 'Warehouse 62', 80000, '516', 'Sunflower St', 'Blvd', 'Suite260', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (64, 'WH000064', 'Warehouse 64', 82000, '518', 'Magnolia St', 'Ave', 'Suite261', 'Encino', 'Los Angeles', 'CA', '91316', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (65, 'WH000065', 'Warehouse 65', 83000, '519', 'Rose St', 'Blvd', 'Suite262', 'Tarzana', 'Los Angeles', 'CA', '91356', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (66, 'WH000066', 'Warehouse 66', 84000, '520', 'Tulip St', 'Ln', 'Suite263', 'Northridge', 'Los Angeles', 'CA', '91324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (67, 'WH000067', 'Warehouse 67', 85000, '521', 'Lily St', 'St', 'Suite264', 'Woodland Hills', 'Los Angeles', 'CA', '91367', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (68, 'WH000068', 'Warehouse 68', 86000, '522', 'Jasmine St', 'Ave', 'Suite265', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (69, 'WH000069', 'Warehouse 69', 87000, '523', 'Sunflower St', 'Blvd', 'Suite266', 'Bel Air', 'Los Angeles', 'CA', '90077', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (70, 'WH000070', 'Warehouse 70', 88000, '524', 'Hibiscus St', 'Ln', 'Suite267', 'Brentwood', 'Los Angeles', 'CA', '90049', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (71, 'WH000071', 'Warehouse 71', 89000, '525', 'Orchid St', 'St', 'Suite268', 'Palms', 'Los Angeles', 'CA', '90034', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (72, 'WH000072', 'Warehouse 72', 90000, '526', 'Gardenia St', 'Ave', 'Suite269', 'Marina del Rey', 'Los Angeles', 'CA', '90292', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (73, 'WH000073', 'Warehouse 73', 91000, '527', 'Lily St', 'Blvd', 'Suite270', 'Venice', 'Los Angeles', 'CA', '90291', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (74, 'WH000074', 'Warehouse 74', 92000, '528', 'Azalea St', 'Ln', 'Suite271', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (75, 'WH000075', 'Warehouse 75', 93000, '529', 'Jasmine St', 'St', 'Suite272', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (76, 'WH000076', 'Warehouse 76', 94000, '530', 'Sunflower St', 'Ave', 'Suite273', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (77, 'WH000077', 'Warehouse 77', 95000, '531', 'Daisy St', 'Blvd', 'Suite274', 'Encino', 'Los Angeles', 'CA', '91316', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (78, 'WH000078', 'Warehouse 78', 96000, '532', 'Magnolia St', 'Ln', 'Suite275', 'Tarzana', 'Los Angeles', 'CA', '91356', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (79, 'WH000079', 'Warehouse 79', 97000, '533', 'Rose St', 'St', 'Suite276', 'Northridge', 'Los Angeles', 'CA', '91324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (80, 'WH000080', 'Warehouse 80', 98000, '534', 'Tulip St', 'Ave', 'Suite277', 'Woodland Hills', 'Los Angeles', 'CA', '91367', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (81, 'WH000081', 'Warehouse 81', 99000, '535', 'Lily St', 'Blvd', 'Suite278', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (82, 'WH000082', 'Warehouse 82', 100000, '536', 'Jasmine St', 'Ln', 'Suite279', 'Bel Air', 'Los Angeles', 'CA', '90077', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (83, 'WH000083', 'Warehouse 83', 101000, '537', 'Sunflower St', 'St', 'Suite280', 'Brentwood', 'Los Angeles', 'CA', '90049', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (84, 'WH000084', 'Warehouse 84', 102000, '538', 'Hibiscus St', 'Ave', 'Suite281', 'Palms', 'Los Angeles', 'CA', '90034', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (85, 'WH000085', 'Warehouse 85', 103000, '539', 'Orchid St', 'Blvd', 'Suite282', 'Marina del Rey', 'Los Angeles', 'CA', '90292', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (86, 'WH000086', 'Warehouse 86', 104000, '540', 'Gardenia St', 'Ln', 'Suite283', 'Venice', 'Los Angeles', 'CA', '90291', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (87, 'WH000087', 'Warehouse 87', 105000, '541', 'Lily St', 'St', 'Suite284', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (88, 'WH000088', 'Warehouse 88', 106000, '542', 'Azalea St', 'Ave', 'Suite285', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (89, 'WH000089', 'Warehouse 89', 107000, '543', 'Jasmine St', 'Blvd', 'Suite286', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (90, 'WH000090', 'Warehouse 90', 108000, '544', 'Sunflower St', 'Ln', 'Suite287', 'Encino', 'Los Angeles', 'CA', '91316', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (91, 'WH000091', 'Warehouse 91', 109000, '545', 'Daisy St', 'St', 'Suite288', 'Tarzana', 'Los Angeles', 'CA', '91356', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (92, 'WH000092', 'Warehouse 92', 110000, '546', 'Magnolia St', 'Ave', 'Suite289', 'Northridge', 'Los Angeles', 'CA', '91324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (93, 'WH000093', 'Warehouse 93', 111000, '547', 'Rose St', 'Blvd', 'Suite290', 'Woodland Hills', 'Los Angeles', 'CA', '91367', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (94, 'WH000094', 'Warehouse 94', 112000, '548', 'Tulip St', 'Ln', 'Suite291', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (95, 'WH000095', 'Warehouse 95', 113000, '549', 'Lily St', 'St', 'Suite292', 'Bel Air', 'Los Angeles', 'CA', '90077', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (96, 'WH000096', 'Warehouse 96', 114000, '550', 'Jasmine St', 'Ave', 'Suite293', 'Brentwood', 'Los Angeles', 'CA', '90049', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (97, 'WH000097', 'Warehouse 97', 115000, '551', 'Sunflower St', 'Blvd', 'Suite294', 'Palms', 'Los Angeles', 'CA', '90034', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (98, 'WH000098', 'Warehouse 98', 116000, '552', 'Hibiscus St', 'Ln', 'Suite295', 'Marina del Rey', 'Los Angeles', 'CA', '90292', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (99, 'WH000099', 'Warehouse 99', 117000, '553', 'Orchid St', 'St', 'Suite296', 'Venice', 'Los Angeles', 'CA', '90291', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (100, 'WH000100', 'Warehouse 100', 118000, '554', 'Gardenia St', 'Ave', 'Suite297', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (101, 'WH000101', 'Warehouse 101', 119000, '555', 'Lily St', 'Blvd', 'Suite298', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (102, 'WH000102', 'Warehouse 102', 120000, '556', 'Azalea St', 'Ln', 'Suite299', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (103, 'WH000103', 'Warehouse 103', 121000, '557', 'Jasmine St', 'Ave', 'Suite300', 'Encino', 'Los Angeles', 'CA', '91316', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (104, 'WH000104', 'Warehouse 104', 122000, '558', 'Sunflower St', 'St', 'Suite301', 'Tarzana', 'Los Angeles', 'CA', '91356', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (105, 'WH000105', 'Warehouse 105', 123000, '559', 'Hibiscus St', 'Blvd', 'Suite302', 'Northridge', 'Los Angeles', 'CA', '91324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (106, 'WH000106', 'Warehouse 106', 124000, '560', 'Orchid St', 'Ln', 'Suite303', 'Woodland Hills', 'Los Angeles', 'CA', '91367', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (107, 'WH000107', 'Warehouse 107', 125000, '561', 'Gardenia St', 'St', 'Suite304', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (108, 'WH000108', 'Warehouse 108', 126000, '562', 'Lily St', 'Ave', 'Suite305', 'Bel Air', 'Los Angeles', 'CA', '90077', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (109, 'WH000109', 'Warehouse 109', 127000, '563', 'Jasmine St', 'Blvd', 'Suite306', 'Brentwood', 'Los Angeles', 'CA', '90049', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (110, 'WH000110', 'Warehouse 110', 128000, '564', 'Sunflower St', 'Ln', 'Suite307', 'Palms', 'Los Angeles', 'CA', '90034', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (111, 'WH000111', 'Warehouse 111', 129000, '565', 'Hibiscus St', 'St', 'Suite308', 'Marina del Rey', 'Los Angeles', 'CA', '90292', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (112, 'WH000112', 'Warehouse 112', 130000, '566', 'Orchid St', 'Ave', 'Suite309', 'Venice', 'Los Angeles', 'CA', '90291', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (113, 'WH000113', 'Warehouse 113', 131000, '567', 'Gardenia St', 'Blvd', 'Suite310', 'Culver City', 'Los Angeles', 'CA', '90232', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (114, 'WH000114', 'Warehouse 114', 132000, '568', 'Lily St', 'Ln', 'Suite311', 'Santa Monica', 'Los Angeles', 'CA', '90401', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (115, 'WH000115', 'Warehouse 115', 133000, '569', 'Azalea St', 'St', 'Suite312', 'West Hollywood', 'Los Angeles', 'CA', '90046', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (116, 'WH000116', 'Warehouse 116', 134000, '570', 'Jasmine St', 'Ave', 'Suite313', 'Encino', 'Los Angeles', 'CA', '91316', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (117, 'WH000117', 'Warehouse 117', 135000, '571', 'Sunflower St', 'Blvd', 'Suite314', 'Tarzana', 'Los Angeles', 'CA', '91356', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (118, 'WH000118', 'Warehouse 118', 136000, '572', 'Hibiscus St', 'Ln', 'Suite315', 'Northridge', 'Los Angeles', 'CA', '91324', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (119, 'WH000119', 'Warehouse 119', 137000, '573', 'Orchid St', 'St', 'Suite316', 'Woodland Hills', 'Los Angeles', 'CA', '91367', 'USA', -8.00);
INSERT INTO tpcds.warehouse_t1 VALUES (120, 'WH000120', 'Warehouse 120', 138000, '574', 'Gardenia St', 'Ave', 'Suite317', 'Beverly Hills', 'Los Angeles', 'CA', '90210', 'USA', -8.00);
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 1', W_WAREHOUSE_SQ_FT = 22000
WHERE (W_STATE = 'CA' AND W_WAREHOUSE_SQ_FT < 20000)
   OR (W_CITY = 'Los Angeles' AND W_WAREHOUSE_ID LIKE 'WH000%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'New Street', W_SUITE_NUMBER = 'Suite 301'
WHERE (W_CITY = 'New York' AND W_STATE = 'NY')
   OR (W_WAREHOUSE_ID = 'WH000015' AND W_STREET_TYPE = 'Ave');
UPDATE tpcds.warehouse_t1
SET W_COUNTY = 'Updated County', W_ZIP = '12345'
WHERE (W_WAREHOUSE_SQ_FT BETWEEN 15000 AND 20000 AND W_STATE = 'TX')
   OR (W_CITY = 'Dallas' AND W_WAREHOUSE_ID LIKE 'WH%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'Main Ave', W_WAREHOUSE_NAME = 'Updated Warehouse 2'
WHERE (W_CITY = 'San Francisco' AND W_WAREHOUSE_SQ_FT > 15000)
   OR (W_ZIP LIKE '941%' AND W_STREET_TYPE = 'Blvd');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_SQ_FT = 18000, W_WAREHOUSE_NAME = 'Updated Warehouse 3'
WHERE (W_STATE = 'FL' AND W_WAREHOUSE_SK BETWEEN 30 AND 40)
   OR (W_CITY = 'Miami' AND W_WAREHOUSE_ID = 'WH000020');
UPDATE tpcds.warehouse_t1
SET W_COUNTRY = 'Updated Country', W_SUITE_NUMBER = 'Suite 400'
WHERE (W_WAREHOUSE_SQ_FT < 25000 AND W_STATE = 'CA')
   OR (W_CITY = 'San Diego' AND W_WAREHOUSE_ID LIKE 'WH%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NUMBER = '789', W_WAREHOUSE_NAME = 'Updated Warehouse 4'
WHERE (W_CITY = 'Seattle' AND W_STATE = 'WA')
   OR (W_ZIP LIKE '98%' AND W_WAREHOUSE_SQ_FT BETWEEN 10000 AND 15000);
UPDATE tpcds.warehouse_t1
SET W_COUNTY = 'New County', W_WAREHOUSE_ID = 'WH000025'
WHERE (W_WAREHOUSE_SQ_FT > 20000 AND W_STATE = 'NY')
   OR (W_CITY = 'Brooklyn' AND W_STREET_NAME LIKE '%Street');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 5', W_STREET_TYPE = 'Road'
WHERE (W_STATE = 'IL' AND W_WAREHOUSE_SK IN (10, 20, 30))
   OR (W_CITY = 'Chicago' AND W_ZIP LIKE '60%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'Elm Street', W_SUITE_NUMBER = 'Suite 500'
WHERE (W_WAREHOUSE_SQ_FT BETWEEN 12000 AND 18000 AND W_STATE = 'TX')
   OR (W_CITY = 'Houston' AND W_WAREHOUSE_ID LIKE 'WH000%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_SQ_FT = 17000, W_COUNTY = 'Updated County'
WHERE (W_CITY = 'Atlanta' AND W_ZIP LIKE '303%')
   OR (W_STATE = 'GA' AND W_WAREHOUSE_ID = 'WH000030');
UPDATE tpcds.warehouse_t1
SET W_CITY = 'Philadelphia', W_WAREHOUSE_NAME = 'Updated Warehouse 6'
WHERE (W_STATE = 'PA' AND W_WAREHOUSE_SQ_FT > 25000)
   OR (W_ZIP LIKE '191%' AND W_STREET_TYPE = 'Blvd');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 7', W_WAREHOUSE_SQ_FT = 16000
WHERE (W_STATE = 'NV' AND W_CITY = 'Las Vegas')
   OR (W_ZIP LIKE '89%' AND W_WAREHOUSE_ID LIKE 'WH%');
UPDATE tpcds.warehouse_t1
SET W_STREET_TYPE = 'Pl', W_SUITE_NUMBER = 'Suite 600'
WHERE (W_WAREHOUSE_SK BETWEEN 40 AND 50 AND W_STATE = 'WA')
   OR (W_CITY = 'Seattle' AND W_WAREHOUSE_SQ_FT < 20000);
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 8', W_COUNTY = 'Updated County'
WHERE (W_STATE = 'NJ' AND W_WAREHOUSE_SQ_FT > 15000)
   OR (W_ZIP LIKE '070%' AND W_WAREHOUSE_ID = 'WH000040');
UPDATE tpcds.warehouse_t1
SET W_CITY = 'Austin', W_WAREHOUSE_NAME = 'Updated Warehouse 9'
WHERE (W_STATE = 'TX' AND W_WAREHOUSE_SK IN (50, 60, 70))
   OR (W_WAREHOUSE_SQ_FT BETWEEN 15000 AND 20000 AND W_ZIP LIKE '73%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'Sunset Blvd', W_SUITE_NUMBER = 'Suite 700'
WHERE (W_CITY = 'Los Angeles' AND W_STATE = 'CA')
   OR (W_WAREHOUSE_SQ_FT > 25000 AND W_ZIP LIKE '900%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 10', W_STREET_TYPE = 'Lane'
WHERE (W_STATE = 'FL' AND W_CITY = 'Orlando')
   OR (W_WAREHOUSE_ID LIKE 'WH000%' AND W_WAREHOUSE_SQ_FT < 20000);
UPDATE tpcds.warehouse_t1
SET W_COUNTY = 'New County', W_WAREHOUSE_SQ_FT = 14000
WHERE (W_WAREHOUSE_ID LIKE 'WH%' AND W_STATE = 'OH')
   OR (W_CITY = 'Columbus' AND W_ZIP LIKE '43%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NUMBER = '234', W_WAREHOUSE_NAME = 'Updated Warehouse 11'
WHERE (W_CITY = 'Cleveland' AND W_STATE = 'OH')
   OR (W_WAREHOUSE_SQ_FT BETWEEN 10000 AND 15000 AND W_ZIP LIKE '44%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 12', W_WAREHOUSE_SQ_FT = 19000
WHERE (W_STATE = 'NC' AND W_CITY = 'Charlotte')
   OR (W_ZIP LIKE '282%' AND W_WAREHOUSE_ID LIKE 'WH000%');
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'Fifth Ave', W_SUITE_NUMBER = 'Suite 800'
WHERE (W_WAREHOUSE_SQ_FT > 20000 AND W_STATE = 'NY')
   OR (W_CITY = 'New York' AND W_ZIP LIKE '10%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 13', W_COUNTY = 'New County'
WHERE (W_STATE = 'MI' AND W_CITY = 'Detroit')
   OR (W_ZIP LIKE '482%' AND W_WAREHOUSE_SQ_FT < 15000);
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_SQ_FT = 21000, W_STREET_TYPE = 'Parkway'
WHERE (W_CITY = 'Denver' AND W_STATE = 'CO')
   OR (W_WAREHOUSE_ID LIKE 'WH000%' AND W_ZIP LIKE '80%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 14', W_SUITE_NUMBER = 'Suite 900'
WHERE (W_STATE = 'WA' AND W_CITY = 'Seattle')
   OR (W_ZIP LIKE '98%' AND W_WAREHOUSE_SQ_FT BETWEEN 12000 AND 15000);
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 15', W_COUNTY = 'Updated County'
WHERE (W_STATE = 'MD' AND W_CITY = 'Baltimore')
   OR (W_ZIP LIKE '212%' AND W_WAREHOUSE_SQ_FT < 20000);
UPDATE tpcds.warehouse_t1
SET W_STREET_NAME = 'Seventh Ave', W_SUITE_NUMBER = 'Suite 1000'
WHERE (W_CITY = 'Philadelphia' AND W_STATE = 'PA')
   OR (W_WAREHOUSE_ID LIKE 'WH000%' AND W_ZIP LIKE '19%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 16', W_WAREHOUSE_SQ_FT = 16000
WHERE (W_STATE = 'VA' AND W_WAREHOUSE_SK IN (80, 90))
   OR (W_CITY = 'Richmond' AND W_ZIP LIKE '23%');
UPDATE tpcds.warehouse_t1
SET W_WAREHOUSE_NAME = 'Updated Warehouse 17', W_STREET_NUMBER = '345'
WHERE (W_CITY = 'San Jose' AND W_STATE = 'CA')
   OR (W_WAREHOUSE_SQ_FT BETWEEN 15000 AND 20000 AND W_ZIP LIKE '95%');
UPDATE tpcds.warehouse_t1
SET W_COUNTY = 'Updated County', W_WAREHOUSE_NAME = 'Updated Warehouse 18'
WHERE (W_WAREHOUSE_ID LIKE 'WH%' AND W_STATE = 'NJ')
   OR (W_CITY = 'Newark' AND W_ZIP LIKE '07%');
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 1;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 2;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 3;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 4;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 5;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 6;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 7;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 8;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 9;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 10;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 11;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 12;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 13;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 14;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 15;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 16;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 17;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 18;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 19;
DELETE FROM tpcds.warehouse_t1 WHERE W_WAREHOUSE_SK = 20;
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_SQ_FT < 20000 AND W_STATE = 'CA')
   OR (W_CITY = 'New York' AND W_GMT_OFFSET = -5.00);
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_NAME LIKE 'Warehouse%' AND W_COUNTY = 'Kings')
   OR (W_ZIP BETWEEN '10001' AND '10010' AND W_STATE = 'NY');
DELETE FROM tpcds.warehouse_t1
WHERE (W_STREET_NAME = 'Broadway' AND W_SUITE_NUMBER IS NOT NULL)
   OR (W_CITY = 'San Francisco' AND W_WAREHOUSE_SQ_FT > 15000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_ID LIKE 'WH%' AND W_COUNTRY = 'USA')
   OR (W_STREET_TYPE = 'Ave' AND W_WAREHOUSE_SQ_FT < 10000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_STATE = 'TX' AND W_COUNTY != 'Harris')
   OR (W_WAREHOUSE_NAME LIKE '%Center%' AND W_GMT_OFFSET BETWEEN -7.00 AND -6.00);
DELETE FROM tpcds.warehouse_t1
WHERE (W_CITY = 'Chicago' AND W_ZIP LIKE '60%')
   OR (W_WAREHOUSE_SK IN (10, 20, 30) AND W_WAREHOUSE_SQ_FT > 25000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_NAME = 'Warehouse 15' AND W_COUNTY = 'Cook')
   OR (W_STREET_NAME = 'Elm St' AND W_STATE = 'IL');
DELETE FROM tpcds.warehouse_t1
WHERE (W_SUITE_NUMBER IS NULL AND W_CITY = 'Dallas')
   OR (W_STREET_TYPE = 'Blvd' AND W_WAREHOUSE_SQ_FT < 30000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_ZIP LIKE '9%' AND W_STATE = 'WA')
   OR (W_COUNTY IN ('King', 'Pierce') AND W_WAREHOUSE_SQ_FT BETWEEN 15000 AND 20000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_STREET_NUMBER = '123' AND W_CITY = 'Houston')
   OR (W_WAREHOUSE_ID = 'WH000022' AND W_COUNTRY = 'USA');
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_NAME LIKE '%Warehouse%' AND W_COUNTY = 'Montgomery')
   OR (W_WAREHOUSE_SQ_FT < 15000 AND W_STATE = 'AL');
DELETE FROM tpcds.warehouse_t1
WHERE (W_STREET_NAME = 'Main St' AND W_SUITE_NUMBER LIKE 'Suite%')
   OR (W_WAREHOUSE_ID BETWEEN 'WH000010' AND 'WH000020' AND W_WAREHOUSE_SQ_FT > 20000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_CITY = 'Seattle' AND W_STATE = 'WA')
   OR (W_ZIP LIKE '98%' AND W_WAREHOUSE_NAME LIKE 'Warehouse%');
DELETE FROM tpcds.warehouse_t1
WHERE (W_STREET_TYPE = 'Rd' AND W_WAREHOUSE_SQ_FT < 18000)
   OR (W_WAREHOUSE_ID LIKE 'WH000%' AND W_COUNTRY = 'USA');
DELETE FROM tpcds.warehouse_t1
WHERE (W_CITY IN ('Denver', 'Aurora') AND W_STATE = 'CO')
   OR (W_WAREHOUSE_NAME LIKE 'Center%' AND W_ZIP LIKE '80%');
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_SK BETWEEN 50 AND 60 AND W_STATE = 'FL')
   OR (W_WAREHOUSE_ID = 'WH000055' AND W_CITY = 'Orlando');
DELETE FROM tpcds.warehouse_t1
WHERE (W_COUNTY = 'San Mateo' AND W_STREET_NAME LIKE '%Ave')
   OR (W_WAREHOUSE_SQ_FT > 20000 AND W_STATE = 'CA');
DELETE FROM tpcds.warehouse_t1
WHERE (W_STREET_TYPE = 'Drive' AND W_WAREHOUSE_NAME LIKE 'Warehouse 4%')
   OR (W_WAREHOUSE_ID = 'WH000014' AND W_CITY = 'San Diego');
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_SQ_FT < 15000 AND W_STATE = 'NC')
   OR (W_STREET_NUMBER LIKE '9%' AND W_CITY = 'Charlotte');
DELETE FROM tpcds.warehouse_t1
WHERE (W_WAREHOUSE_NAME LIKE '%Warehouse%' AND W_CITY = 'Miami')
   OR (W_ZIP LIKE '33%' AND W_WAREHOUSE_SQ_FT BETWEEN 10000 AND 15000);
DELETE FROM tpcds.warehouse_t1
WHERE (W_STATE = 'VA' AND W_WAREHOUSE_SK IN (101, 102, 103))
   OR (W_STREET_TYPE = 'Court' AND W_CITY = 'Richmond');
with wscs as
 (select sold_date_sk
        ,sales_price
  from (select ws_sold_date_sk sold_date_sk
              ,ws_ext_sales_price sales_price
        from web_sales
        union all
        select cs_sold_date_sk sold_date_sk
              ,cs_ext_sales_price sales_price
        from catalog_sales)),
 wswscs as
 (select d_week_seq,
        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales
 from wscs
     ,date_dim
 where d_date_sk = sold_date_sk
 group by d_week_seq)
 select d_week_seq1
       ,round(sun_sales1/sun_sales2,2)
       ,round(mon_sales1/mon_sales2,2)
       ,round(tue_sales1/tue_sales2,2)
       ,round(wed_sales1/wed_sales2,2)
       ,round(thu_sales1/thu_sales2,2)
       ,round(fri_sales1/fri_sales2,2)
       ,round(sat_sales1/sat_sales2,2)
 from
 (select wswscs.d_week_seq d_week_seq1
        ,sun_sales sun_sales1
        ,mon_sales mon_sales1
        ,tue_sales tue_sales1
        ,wed_sales wed_sales1
        ,thu_sales thu_sales1
        ,fri_sales fri_sales1
        ,sat_sales sat_sales1
  from wswscs,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998) y,
 (select wswscs.d_week_seq d_week_seq2
        ,sun_sales sun_sales2
        ,mon_sales mon_sales2
        ,tue_sales tue_sales2
        ,wed_sales wed_sales2
        ,thu_sales thu_sales2
        ,fri_sales fri_sales2
        ,sat_sales sat_sales2
  from wswscs
      ,date_dim
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 1998+1) z
 where d_week_seq1=d_week_seq2-53
 order by d_week_seq1;
 with customer_total_return as
 (select sr_customer_sk as ctr_customer_sk
 ,sr_store_sk as ctr_store_sk
 ,sum(SR_FEE) as ctr_total_return
 from store_returns
 ,date_dim
 where sr_returned_date_sk = d_date_sk
 and d_year =2000
 group by sr_customer_sk
 ,sr_store_sk)
  select  c_customer_id
 from customer_total_return ctr1
 ,store
 ,customer
 where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
 from customer_total_return ctr2
 where ctr1.ctr_store_sk = ctr2.ctr_store_sk)
 and s_store_sk = ctr1.ctr_store_sk
 and s_state = 'NM'
 and ctr1.ctr_customer_sk = c_customer_sk
 order by c_customer_id
 limit 100;
 select  dt.d_year
        ,item.i_brand_id brand_id
        ,item.i_brand brand
        ,sum(ss_sales_price) sum_agg
  from  date_dim dt
       ,store_sales
       ,item
  where dt.d_date_sk = store_sales.ss_sold_date_sk
    and store_sales.ss_item_sk = item.i_item_sk
    and item.i_manufact_id = 816
    and dt.d_moy=11
  group by dt.d_year
       ,item.i_brand
       ,item.i_brand_id
  order by dt.d_year
          ,sum_agg desc
          ,brand_id
  limit 100;
  with year_total as (
   select c_customer_id customer_id
         ,c_first_name customer_first_name
         ,c_last_name customer_last_name
         ,c_preferred_cust_flag customer_preferred_cust_flag
         ,c_birth_country customer_birth_country
         ,c_login customer_login
         ,c_email_address customer_email_address
         ,d_year dyear
         ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total
         ,'s' sale_type
   from customer
       ,store_sales
       ,date_dim
   where c_customer_sk = ss_customer_sk
     and ss_sold_date_sk = d_date_sk
   group by c_customer_id
           ,c_first_name
           ,c_last_name
           ,c_preferred_cust_flag
           ,c_birth_country
           ,c_login
           ,c_email_address
           ,d_year
   union all
   select c_customer_id customer_id
         ,c_first_name customer_first_name
         ,c_last_name customer_last_name
         ,c_preferred_cust_flag customer_preferred_cust_flag
         ,c_birth_country customer_birth_country
         ,c_login customer_login
         ,c_email_address customer_email_address
         ,d_year dyear
         ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total
         ,'c' sale_type
   from customer
       ,catalog_sales
       ,date_dim
   where c_customer_sk = cs_bill_customer_sk
     and cs_sold_date_sk = d_date_sk
   group by c_customer_id
           ,c_first_name
           ,c_last_name
           ,c_preferred_cust_flag
           ,c_birth_country
           ,c_login
           ,c_email_address
           ,d_year
  union all
   select c_customer_id customer_id
         ,c_first_name customer_first_name
         ,c_last_name customer_last_name
         ,c_preferred_cust_flag customer_preferred_cust_flag
         ,c_birth_country customer_birth_country
         ,c_login customer_login
         ,c_email_address customer_email_address
         ,d_year dyear
         ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total
         ,'w' sale_type
   from customer
       ,web_sales
       ,date_dim
   where c_customer_sk = ws_bill_customer_sk
     and ws_sold_date_sk = d_date_sk
   group by c_customer_id
           ,c_first_name
           ,c_last_name
           ,c_preferred_cust_flag
           ,c_birth_country
           ,c_login
           ,c_email_address
           ,d_year
           )
    select
                    t_s_secyear.customer_id
                   ,t_s_secyear.customer_first_name
                   ,t_s_secyear.customer_last_name
                   ,t_s_secyear.customer_birth_country
   from year_total t_s_firstyear
       ,year_total t_s_secyear
       ,year_total t_c_firstyear
       ,year_total t_c_secyear
       ,year_total t_w_firstyear
       ,year_total t_w_secyear
   where t_s_secyear.customer_id = t_s_firstyear.customer_id
     and t_s_firstyear.customer_id = t_c_secyear.customer_id
     and t_s_firstyear.customer_id = t_c_firstyear.customer_id
     and t_s_firstyear.customer_id = t_w_firstyear.customer_id
     and t_s_firstyear.customer_id = t_w_secyear.customer_id
     and t_s_firstyear.sale_type = 's'
     and t_c_firstyear.sale_type = 'c'
     and t_w_firstyear.sale_type = 'w'
     and t_s_secyear.sale_type = 's'
     and t_c_secyear.sale_type = 'c'
     and t_w_secyear.sale_type = 'w'
     and t_s_firstyear.dyear =  1999
     and t_s_secyear.dyear = 1999+1
     and t_c_firstyear.dyear =  1999
     and t_c_secyear.dyear =  1999+1
     and t_w_firstyear.dyear = 1999
     and t_w_secyear.dyear = 1999+1
     and t_s_firstyear.year_total > 0
     and t_c_firstyear.year_total > 0
     and t_w_firstyear.year_total > 0
     and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
     and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
             > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
   order by t_s_secyear.customer_id
           ,t_s_secyear.customer_first_name
           ,t_s_secyear.customer_last_name
           ,t_s_secyear.customer_birth_country
  limit 100;
with ssr as
 (select s_store_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ss_store_sk as store_sk,
            ss_sold_date_sk  as date_sk,
            ss_ext_sales_price as sales_price,
            ss_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from store_sales
    union all
    select sr_store_sk as store_sk,
           sr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           sr_return_amt as return_amt,
           sr_net_loss as net_loss
    from store_returns
   ) salesreturns,
     date_dim,
     store
 where date_sk = d_date_sk
       and d_date between cast('2000-08-19' as date)
                  and (cast('2000-08-19' as date) +  INTERVAL '14 days')
       and store_sk = s_store_sk
 group by s_store_id)
 ,
 csr as
 (select cp_catalog_page_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  cs_catalog_page_sk as page_sk,
            cs_sold_date_sk  as date_sk,
            cs_ext_sales_price as sales_price,
            cs_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from catalog_sales
    union all
    select cr_catalog_page_sk as page_sk,
           cr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           cr_return_amount as return_amt,
           cr_net_loss as net_loss
    from catalog_returns
   ) salesreturns,
     date_dim,
     catalog_page
 where date_sk = d_date_sk
       and d_date between cast('2000-08-19' as date)
                  and (cast('2000-08-19' as date) +  INTERVAL '14 days')
       and page_sk = cp_catalog_page_sk
 group by cp_catalog_page_id)
 ,
 wsr as
 (select web_site_id,
        sum(sales_price) as sales,
        sum(profit) as profit,
        sum(return_amt) as returns,
        sum(net_loss) as profit_loss
 from
  ( select  ws_web_site_sk as wsr_web_site_sk,
            ws_sold_date_sk  as date_sk,
            ws_ext_sales_price as sales_price,
            ws_net_profit as profit,
            cast(0 as decimal(7,2)) as return_amt,
            cast(0 as decimal(7,2)) as net_loss
    from web_sales
    union all
    select ws_web_site_sk as wsr_web_site_sk,
           wr_returned_date_sk as date_sk,
           cast(0 as decimal(7,2)) as sales_price,
           cast(0 as decimal(7,2)) as profit,
           wr_return_amt as return_amt,
           wr_net_loss as net_loss
    from web_returns left outer join web_sales on
         ( wr_item_sk = ws_item_sk
           and wr_order_number = ws_order_number)
   ) salesreturns,
     date_dim,
     web_site
 where date_sk = d_date_sk
       and d_date between cast('2000-08-19' as date)
                  and (cast('2000-08-19' as date) +  INTERVAL '14 days')
       and wsr_web_site_sk = web_site_sk
 group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from
 (select 'store channel' as channel
        , 'store' || s_store_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || cp_catalog_page_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , (profit - profit_loss) as profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;
select  a.ca_state state, count(*) cnt
  from customer_address a
      ,customer c
      ,store_sales s
      ,date_dim d
      ,item i
  where       a.ca_address_sk = c.c_current_addr_sk
  	and c.c_customer_sk = s.ss_customer_sk
  	and s.ss_sold_date_sk = d.d_date_sk
  	and s.ss_item_sk = i.i_item_sk
  	and d.d_month_seq =
  	     (select distinct (d_month_seq)
  	      from date_dim
                where d_year = 2002
  	        and d_moy = 3 )
  	and i.i_current_price > 1.2 *
              (select avg(j.i_current_price)
  	     from item j
  	     where j.i_category = i.i_category)
  group by a.ca_state
  having count(*) >= 10
  order by cnt, a.ca_state
  limit 100;
select  i_item_id,
        avg(ss_quantity) agg1,
        avg(ss_list_price) agg2,
        avg(ss_coupon_amt) agg3,
        avg(ss_sales_price) agg4
 from store_sales, customer_demographics, date_dim, item, promotion
 where ss_sold_date_sk = d_date_sk and
       ss_item_sk = i_item_sk and
       ss_cdemo_sk = cd_demo_sk and
       ss_promo_sk = p_promo_sk and
       cd_gender = 'F' and
       cd_marital_status = 'W' and
       cd_education_status = 'College' and
       (p_channel_email = 'N' or p_channel_event = 'N') and
       d_year = 2001
 group by i_item_id
 order by i_item_id
 limit 100;
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '47602','16704','35863','28577','83910','36201',
                          '58412','48162','28055','41419','80332',
                          '38607','77817','24891','16226','18410',
                          '21231','59345','13918','51089','20317',
                          '17167','54585','67881','78366','47770',
                          '18360','51717','73108','14440','21800',
                          '89338','45859','65501','34948','25973',
                          '73219','25333','17291','10374','18829',
                          '60736','82620','41351','52094','19326',
                          '25214','54207','40936','21814','79077',
                          '25178','75742','77454','30621','89193',
                          '27369','41232','48567','83041','71948',
                          '37119','68341','14073','16891','62878',
                          '49130','19833','24286','27700','40979',
                          '50412','81504','94835','84844','71954',
                          '39503','57649','18434','24987','12350',
                          '86379','27413','44529','98569','16515',
                          '27287','24255','21094','16005','56436',
                          '91110','68293','56455','54558','10298',
                          '83647','32754','27052','51766','19444',
                          '13869','45645','94791','57631','20712',
                          '37788','41807','46507','21727','71836',
                          '81070','50632','88086','63991','20244',
                          '31655','51782','29818','63792','68605',
                          '94898','36430','57025','20601','82080',
                          '33869','22728','35834','29086','92645',
                          '98584','98072','11652','78093','57553',
                          '43830','71144','53565','18700','90209',
                          '71256','38353','54364','28571','96560',
                          '57839','56355','50679','45266','84680',
                          '34306','34972','48530','30106','15371',
                          '92380','84247','92292','68852','13338',
                          '34594','82602','70073','98069','85066',
                          '47289','11686','98862','26217','47529',
                          '63294','51793','35926','24227','14196',
                          '24594','32489','99060','49472','43432',
                          '49211','14312','88137','47369','56877',
                          '20534','81755','15794','12318','21060',
                          '73134','41255','63073','81003','73873',
                          '66057','51184','51195','45676','92696',
                          '70450','90669','98338','25264','38919',
                          '59226','58581','60298','17895','19489',
                          '52301','80846','95464','68770','51634',
                          '19988','18367','18421','11618','67975',
                          '25494','41352','95430','15734','62585',
                          '97173','33773','10425','75675','53535',
                          '17879','41967','12197','67998','79658',
                          '59130','72592','14851','43933','68101',
                          '50636','25717','71286','24660','58058',
                          '72991','95042','15543','33122','69280',
                          '11912','59386','27642','65177','17672',
                          '33467','64592','36335','54010','18767',
                          '63193','42361','49254','33113','33159',
                          '36479','59080','11855','81963','31016',
                          '49140','29392','41836','32958','53163',
                          '13844','73146','23952','65148','93498',
                          '14530','46131','58454','13376','13378',
                          '83986','12320','17193','59852','46081',
                          '98533','52389','13086','68843','31013',
                          '13261','60560','13443','45533','83583',
                          '11489','58218','19753','22911','25115',
                          '86709','27156','32669','13123','51933',
                          '39214','41331','66943','14155','69998',
                          '49101','70070','35076','14242','73021',
                          '59494','15782','29752','37914','74686',
                          '83086','34473','15751','81084','49230',
                          '91894','60624','17819','28810','63180',
                          '56224','39459','55233','75752','43639',
                          '55349','86057','62361','50788','31830',
                          '58062','18218','85761','60083','45484',
                          '21204','90229','70041','41162','35390',
                          '16364','39500','68908','26689','52868',
                          '81335','40146','11340','61527','61794',
                          '71997','30415','59004','29450','58117',
                          '69952','33562','83833','27385','61860',
                          '96435','48333','23065','32961','84919',
                          '61997','99132','22815','56600','68730',
                          '48017','95694','32919','88217','27116',
                          '28239','58032','18884','16791','21343',
                          '97462','18569','75660','15475')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
select case when (select count(*)
                  from store_sales
                  where ss_quantity between 1 and 20) > 98972190
            then (select avg(ss_ext_discount_amt)
                  from store_sales
                  where ss_quantity between 1 and 20)
            else (select avg(ss_net_profit)
                  from store_sales
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 21 and 40) > 160856845
            then (select avg(ss_ext_discount_amt)
                  from store_sales
                  where ss_quantity between 21 and 40)
            else (select avg(ss_net_profit)
                  from store_sales
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 41 and 60) > 12733327
            then (select avg(ss_ext_discount_amt)
                  from store_sales
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_profit)
                  from store_sales
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 61 and 80) > 96251173
            then (select avg(ss_ext_discount_amt)
                  from store_sales
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_profit)
                  from store_sales
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from store_sales
                  where ss_quantity between 81 and 100) > 80049606
            then (select avg(ss_ext_discount_amt)
                  from store_sales
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_profit)
                  from store_sales
                  where ss_quantity between 81 and 100) end bucket5
from reason
where r_reason_sk = 1;
select
  cd_gender,
  cd_marital_status,
  cd_education_status,
  count(*) cnt1,
  cd_purchase_estimate,
  count(*) cnt2,
  cd_credit_rating,
  count(*) cnt3,
  cd_dep_count,
  count(*) cnt4,
  cd_dep_employed_count,
  count(*) cnt5,
  cd_dep_college_count,
  count(*) cnt6
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  ca_county in ('Fillmore County','McPherson County','Bonneville County','Boone County','Brown County') and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2000 and
                d_moy between 3 and 3+3) and
   (exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2000 and
                  d_moy between 3 ANd 3+3) or
    exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2000 and
                  d_moy between 3 and 3+3))
 group by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 order by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
limit 100;
with year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
         )
  select
                  t_s_secyear.customer_id
                 ,t_s_secyear.customer_first_name
                 ,t_s_secyear.customer_last_name
                 ,t_s_secyear.customer_birth_country
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
         and t_s_firstyear.customer_id = t_w_secyear.customer_id
         and t_s_firstyear.customer_id = t_w_firstyear.customer_id
         and t_s_firstyear.sale_type = 's'
         and t_w_firstyear.sale_type = 'w'
         and t_s_secyear.sale_type = 's'
         and t_w_secyear.sale_type = 'w'
         and t_s_firstyear.dyear = 1999
         and t_s_secyear.dyear = 1999+1
         and t_w_firstyear.dyear = 1999
         and t_w_secyear.dyear = 1999+1
         and t_s_firstyear.year_total > 0
         and t_w_firstyear.year_total > 0
         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end
             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end
 order by t_s_secyear.customer_id
         ,t_s_secyear.customer_first_name
         ,t_s_secyear.customer_last_name
         ,t_s_secyear.customer_birth_country
limit 100;
select  i_item_id
      ,i_item_desc
      ,i_category
      ,i_class
      ,i_current_price
      ,sum(ws_ext_sales_price) as itemrevenue
      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over
          (partition by i_class) as revenueratio
from
	web_sales
    	,item
    	,date_dim
where
	ws_item_sk = i_item_sk
  	and i_category in ('Electronics', 'Books', 'Women')
  	and ws_sold_date_sk = d_date_sk
	and d_date between cast('1998-01-06' as date)
				and (cast('1998-01-06' as date) + INTERVAL '30 days')
group by
	i_item_id
        ,i_item_desc
        ,i_category
        ,i_class
        ,i_current_price
order by
	i_category
        ,i_class
        ,i_item_id
        ,i_item_desc
        ,revenueratio
limit 100;
select avg(ss_quantity)
       ,avg(ss_ext_sales_price)
       ,avg(ss_ext_wholesale_cost)
       ,sum(ss_ext_wholesale_cost)
 from store_sales
     ,store
     ,customer_demographics
     ,household_demographics
     ,customer_address
     ,date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 2001
 and((ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'U'
  and cd_education_status = 'Secondary'
  and ss_sales_price between 100.00 and 150.00
  and hd_dep_count = 3
     )or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'W'
  and cd_education_status = 'College'
  and ss_sales_price between 50.00 and 100.00
  and hd_dep_count = 1
     ) or
     (ss_hdemo_sk=hd_demo_sk
  and cd_demo_sk = ss_cdemo_sk
  and cd_marital_status = 'D'
  and cd_education_status = 'Primary'
  and ss_sales_price between 150.00 and 200.00
  and hd_dep_count = 1
     ))
 and((ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('TX', 'OK', 'MI')
  and ss_net_profit between 100 and 200
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('WA', 'NC', 'OH')
  and ss_net_profit between 150 and 300
     ) or
     (ss_addr_sk = ca_address_sk
  and ca_country = 'United States'
  and ca_state in ('MT', 'FL', 'GA')
  and ss_net_profit between 50 and 250
     ))
;
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 2000 AND 2000 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 2000 AND 2000 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 2000 AND 2000 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
(select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 2000 and 2000 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 2000 and 2000 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 2000 and 2000 + 2) x)
  select  this_year.channel ty_channel
                           ,this_year.i_brand_id ty_brand
                           ,this_year.i_class_id ty_class
                           ,this_year.i_category_id ty_category
                           ,this_year.sales ty_sales
                           ,this_year.number_sales ty_number_sales
                           ,last_year.channel ly_channel
                           ,last_year.i_brand_id ly_brand
                           ,last_year.i_class_id ly_class
                           ,last_year.i_category_id ly_category
                           ,last_year.sales ly_sales
                           ,last_year.number_sales ly_number_sales
 from
 (select 'store' channel, i_brand_id,i_class_id,i_category_id
        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales
 from store_sales
     ,item
     ,date_dim
 where ss_item_sk in (select ss_item_sk from cross_items)
   and ss_item_sk = i_item_sk
   and ss_sold_date_sk = d_date_sk
   and d_week_seq = (select d_week_seq
                     from date_dim
                     where d_year = 2000 + 1
                       and d_moy = 12
                       and d_dom = 15)
 group by i_brand_id,i_class_id,i_category_id
 having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,
 (select 'store' channel, i_brand_id,i_class_id
        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales
 from store_sales
     ,item
     ,date_dim
 where ss_item_sk in (select ss_item_sk from cross_items)
   and ss_item_sk = i_item_sk
   and ss_sold_date_sk = d_date_sk
   and d_week_seq = (select d_week_seq
                     from date_dim
                     where d_year = 2000
                       and d_moy = 12
                       and d_dom = 15)
 group by i_brand_id,i_class_id,i_category_id
 having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year
 where this_year.i_brand_id= last_year.i_brand_id
   and this_year.i_class_id = last_year.i_class_id
   and this_year.i_category_id = last_year.i_category_id
 order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id
 limit 100;
select  ca_zip
       ,sum(cs_sales_price)
 from catalog_sales
     ,customer
     ,customer_address
     ,date_dim
 where cs_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
                                   '85392', '85460', '80348', '81792')
 	      or ca_state in ('CA','WA','GA')
 	      or cs_sales_price > 500)
 	and cs_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 1998
 group by ca_zip
 order by ca_zip
 limit 100;
select
   count(distinct cs_order_number) as "order count"
  ,sum(cs_ext_ship_cost) as "total shipping cost"
  ,sum(cs_net_profit) as "total net profit"
from
   catalog_sales cs1
  ,date_dim
  ,customer_address
  ,call_center
where
    d_date between '1999-4-01' and
           (cast('1999-4-01' as date) + INTERVAL '60 days')
and cs1.cs_ship_date_sk = d_date_sk
and cs1.cs_ship_addr_sk = ca_address_sk
and ca_state = 'IL'
and cs1.cs_call_center_sk = cc_call_center_sk
and cc_county in ('Richland County','Bronx County','Maverick County','Mesa County',
                  'Raleigh County'
)
and exists (select *
            from catalog_sales cs2
            where cs1.cs_order_number = cs2.cs_order_number
              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)
and not exists(select *
               from catalog_returns cr1
               where cs1.cs_order_number = cr1.cr_order_number)
order by count(distinct cs_order_number)
limit 100;
select  i_item_id
       ,i_item_desc
       ,s_state
       ,count(ss_quantity) as store_sales_quantitycount
       ,avg(ss_quantity) as store_sales_quantityave
       ,stddev_samp(ss_quantity) as store_sales_quantitystdev
       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov
       ,count(sr_return_quantity) as store_returns_quantitycount
       ,avg(sr_return_quantity) as store_returns_quantityave
       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev
       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov
       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave
       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev
       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov
 from store_sales
     ,store_returns
     ,catalog_sales
     ,date_dim d1
     ,date_dim d2
     ,date_dim d3
     ,store
     ,item
 where d1.d_quarter_name = '2000Q1'
   and d1.d_date_sk = ss_sold_date_sk
   and i_item_sk = ss_item_sk
   and s_store_sk = ss_store_sk
   and ss_customer_sk = sr_customer_sk
   and ss_item_sk = sr_item_sk
   and ss_ticket_number = sr_ticket_number
   and sr_returned_date_sk = d2.d_date_sk
   and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')
   and sr_customer_sk = cs_bill_customer_sk
   and sr_item_sk = cs_item_sk
   and cs_sold_date_sk = d3.d_date_sk
   and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')
 group by i_item_id
         ,i_item_desc
         ,s_state
 order by i_item_id
         ,i_item_desc
         ,s_state
limit 100;
select  i_item_id,
        ca_country,
        ca_state,
        ca_county,
        avg( cast(cs_quantity as decimal(12,2))) agg1,
        avg( cast(cs_list_price as decimal(12,2))) agg2,
        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,
        avg( cast(cs_sales_price as decimal(12,2))) agg4,
        avg( cast(cs_net_profit as decimal(12,2))) agg5,
        avg( cast(c_birth_year as decimal(12,2))) agg6,
        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7
 from catalog_sales, customer_demographics cd1,
      customer_demographics cd2, customer, customer_address, date_dim, item
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd1.cd_demo_sk and
       cs_bill_customer_sk = c_customer_sk and
       cd1.cd_gender = 'M' and
       cd1.cd_education_status = 'Unknown' and
       c_current_cdemo_sk = cd2.cd_demo_sk and
       c_current_addr_sk = ca_address_sk and
       c_birth_month in (5,1,4,7,8,9) and
       d_year = 2002 and
       ca_state in ('AR','TX','NC'
                   ,'GA','MS','WV','AL')
 group by rollup (i_item_id, ca_country, ca_state, ca_county)
 order by ca_country,
        ca_state,
        ca_county,
	i_item_id
 limit 100;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,
 	sum(ss_ext_sales_price) ext_price
 from date_dim, store_sales, item,customer,customer_address,store
 where d_date_sk = ss_sold_date_sk
   and ss_item_sk = i_item_sk
   and i_manager_id=16
   and d_moy=12
   and d_year=1998
   and ss_customer_sk = c_customer_sk
   and c_current_addr_sk = ca_address_sk
   and substr(ca_zip,1,5) <> substr(s_zip,1,5)
   and ss_store_sk = s_store_sk
 group by i_brand
      ,i_brand_id
      ,i_manufact_id
      ,i_manufact
 order by ext_price desc
         ,i_brand
         ,i_brand_id
         ,i_manufact_id
         ,i_manufact
limit 100 ;
select  i_item_id
       ,i_item_desc
       ,i_category
       ,i_class
       ,i_current_price
       ,sum(cs_ext_sales_price) as itemrevenue
       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over
           (partition by i_class) as revenueratio
 from	catalog_sales
     ,item
     ,date_dim
 where cs_item_sk = i_item_sk
   and i_category in ('Shoes', 'Electronics', 'Children')
   and cs_sold_date_sk = d_date_sk
 and d_date between cast('2001-03-14' as date)
 				and (cast('2001-03-14' as date) + INTERVAL '30 days')
 group by i_item_id
         ,i_item_desc
         ,i_category
         ,i_class
         ,i_current_price
 order by i_category
         ,i_class
         ,i_item_id
         ,i_item_desc
         ,revenueratio
limit 100;
select  *
 from(select w_warehouse_name
            ,i_item_id
            ,sum(case when (cast(d_date as date) < cast ('1999-03-20' as date))
	                then inv_quantity_on_hand
                      else 0 end) as inv_before
            ,sum(case when (cast(d_date as date) >= cast ('1999-03-20' as date))
                      then inv_quantity_on_hand
                      else 0 end) as inv_after
   from inventory
       ,warehouse
       ,item
       ,date_dim
   where i_current_price between 0.99 and 1.49
     and i_item_sk          = inv_item_sk
     and inv_warehouse_sk   = w_warehouse_sk
     and inv_date_sk    = d_date_sk
     and d_date between (cast ('1999-03-20' as date) - INTERVAL '30 days')
                    and (cast ('1999-03-20' as date) + INTERVAL '30 days')
   group by w_warehouse_name, i_item_id) x
 where (case when inv_before > 0
             then inv_after / inv_before
             else null
             end) between 2.0/3.0 and 3.0/2.0
 order by w_warehouse_name
         ,i_item_id
 limit 100;
 select  i_product_name
              ,i_brand
              ,i_class
              ,i_category
              ,avg(inv_quantity_on_hand) qoh
        from inventory
            ,date_dim
            ,item
        where inv_date_sk=d_date_sk
               and inv_item_sk=i_item_sk
               and d_month_seq between 1186 and 1186 + 11
        group by rollup(i_product_name
                        ,i_brand
                        ,i_class
                        ,i_category)
 order by qoh, i_product_name, i_brand, i_class, i_category
 limit 100;
with frequent_ss_items as
 (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt
  from store_sales
      ,date_dim
      ,item
  where ss_sold_date_sk = d_date_sk
    and ss_item_sk = i_item_sk
    and d_year in (2000,2000 + 1,2000 + 2,2000 + 3)
  group by substr(i_item_desc,1,30),i_item_sk,d_date
  having count(*) >4),
 max_store_sales as
 (select max(csales) tpcds_cmax
  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales
        from store_sales
            ,customer
            ,date_dim
        where ss_customer_sk = c_customer_sk
         and ss_sold_date_sk = d_date_sk
         and d_year in (2000,2000+1,2000+2,2000+3)
        group by c_customer_sk)),
 best_ss_customer as
 (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales
  from store_sales
      ,customer
  where ss_customer_sk = c_customer_sk
  group by c_customer_sk
  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select
  *
 from max_store_sales))
  select  c_last_name,c_first_name,sales
 from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales
        from catalog_sales
            ,customer
            ,date_dim
        where d_year = 2000
         and d_moy = 3
         and cs_sold_date_sk = d_date_sk
         and cs_item_sk in (select item_sk from frequent_ss_items)
         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)
         and cs_bill_customer_sk = c_customer_sk
       group by c_last_name,c_first_name
      union all
      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales
       from web_sales
           ,customer
           ,date_dim
       where d_year = 2000
         and d_moy = 3
         and ws_sold_date_sk = d_date_sk
         and ws_item_sk in (select item_sk from frequent_ss_items)
         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)
         and ws_bill_customer_sk = c_customer_sk
       group by c_last_name,c_first_name)
     order by c_last_name,c_first_name,sales
  limit 100;
with ssales as
(select c_last_name
      ,c_first_name
      ,s_store_name
      ,ca_state
      ,s_state
      ,i_color
      ,i_current_price
      ,i_manager_id
      ,i_units
      ,i_size
      ,sum(ss_sales_price) netpaid
from store_sales
    ,store_returns
    ,store
    ,item
    ,customer
    ,customer_address
where ss_ticket_number = sr_ticket_number
  and ss_item_sk = sr_item_sk
  and ss_customer_sk = c_customer_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and c_current_addr_sk = ca_address_sk
  and c_birth_country <> upper(ca_country)
  and s_zip = ca_zip
  and s_market_id = 10
group by c_last_name
        ,c_first_name
        ,s_store_name
        ,ca_state
        ,s_state
        ,i_color
        ,i_current_price
        ,i_manager_id
        ,i_units
        ,i_size)
select c_last_name
      ,c_first_name
      ,s_store_name
      ,sum(netpaid) paid
from ssales
where i_color = 'chiffon'
group by c_last_name
        ,c_first_name
        ,s_store_name
having sum(netpaid) > (select 0.05*avg(netpaid)
                           from ssales)
order by c_last_name
        ,c_first_name
        ,s_store_name
;
select
 i_item_id
 ,i_item_desc
 ,s_store_id
 ,s_store_name
 ,sum(ss_net_profit) as store_sales_profit
 ,sum(sr_net_loss) as store_returns_loss
 ,sum(cs_net_profit) as catalog_sales_profit
 from
 store_sales
 ,store_returns
 ,catalog_sales
 ,date_dim d1
 ,date_dim d2
 ,date_dim d3
 ,store
 ,item
 where
 d1.d_moy = 4
 and d1.d_year = 2000
 and d1.d_date_sk = ss_sold_date_sk
 and i_item_sk = ss_item_sk
 and s_store_sk = ss_store_sk
 and ss_customer_sk = sr_customer_sk
 and ss_item_sk = sr_item_sk
 and ss_ticket_number = sr_ticket_number
 and sr_returned_date_sk = d2.d_date_sk
 and d2.d_moy               between 4 and  10
 and d2.d_year              = 2000
 and sr_customer_sk = cs_bill_customer_sk
 and sr_item_sk = cs_item_sk
 and cs_sold_date_sk = d3.d_date_sk
 and d3.d_moy               between 4 and  10
 and d3.d_year              = 2000
 group by
 i_item_id
 ,i_item_desc
 ,s_store_id
 ,s_store_name
 order by
 i_item_id
 ,i_item_desc
 ,s_store_id
 ,s_store_name
 limit 100;
select  i_item_id,
        avg(cs_quantity) agg1,
        avg(cs_list_price) agg2,
        avg(cs_coupon_amt) agg3,
        avg(cs_sales_price) agg4
 from catalog_sales, customer_demographics, date_dim, item, promotion
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd_demo_sk and
       cs_promo_sk = p_promo_sk and
       cd_gender = 'F' and
       cd_marital_status = 'S' and
       cd_education_status = 'College' and
       (p_channel_email = 'N' or p_channel_event = 'N') and
       d_year = 1998
 group by i_item_id
 order by i_item_id
 limit 100;
select  i_item_id,
        s_state, grouping(s_state) g_state,
        avg(ss_quantity) agg1,
        avg(ss_list_price) agg2,
        avg(ss_coupon_amt) agg3,
        avg(ss_sales_price) agg4
 from store_sales, customer_demographics, date_dim, store, item
 where ss_sold_date_sk = d_date_sk and
       ss_item_sk = i_item_sk and
       ss_store_sk = s_store_sk and
       ss_cdemo_sk = cd_demo_sk and
       cd_gender = 'F' and
       cd_marital_status = 'U' and
       cd_education_status = '2 yr Degree' and
       d_year = 2000 and
       s_state in ('AL','IN', 'SC', 'NY', 'OH', 'FL')
 group by rollup (i_item_id, s_state)
 order by i_item_id
         ,s_state
 limit 100;
select  *
from (select avg(ss_list_price) B1_LP
            ,count(ss_list_price) B1_CNT
            ,count(distinct ss_list_price) B1_CNTD
      from store_sales
      where ss_quantity between 0 and 5
        and (ss_list_price between 73 and 73+10
             or ss_coupon_amt between 7826 and 7826+1000
             or ss_wholesale_cost between 70 and 70+20)) B1,
     (select avg(ss_list_price) B2_LP
            ,count(ss_list_price) B2_CNT
            ,count(distinct ss_list_price) B2_CNTD
      from store_sales
      where ss_quantity between 6 and 10
        and (ss_list_price between 152 and 152+10
          or ss_coupon_amt between 2196 and 2196+1000
          or ss_wholesale_cost between 56 and 56+20)) B2,
     (select avg(ss_list_price) B3_LP
            ,count(ss_list_price) B3_CNT
            ,count(distinct ss_list_price) B3_CNTD
      from store_sales
      where ss_quantity between 11 and 15
        and (ss_list_price between 53 and 53+10
          or ss_coupon_amt between 3430 and 3430+1000
          or ss_wholesale_cost between 13 and 13+20)) B3,
     (select avg(ss_list_price) B4_LP
            ,count(ss_list_price) B4_CNT
            ,count(distinct ss_list_price) B4_CNTD
      from store_sales
      where ss_quantity between 16 and 20
        and (ss_list_price between 182 and 182+10
          or ss_coupon_amt between 3262 and 3262+1000
          or ss_wholesale_cost between 20 and 20+20)) B4,
     (select avg(ss_list_price) B5_LP
            ,count(ss_list_price) B5_CNT
            ,count(distinct ss_list_price) B5_CNTD
      from store_sales
      where ss_quantity between 21 and 25
        and (ss_list_price between 85 and 85+10
          or ss_coupon_amt between 3310 and 3310+1000
          or ss_wholesale_cost between 37 and 37+20)) B5,
     (select avg(ss_list_price) B6_LP
            ,count(ss_list_price) B6_CNT
            ,count(distinct ss_list_price) B6_CNTD
      from store_sales
      where ss_quantity between 26 and 30
        and (ss_list_price between 180 and 180+10
          or ss_coupon_amt between 12592 and 12592+1000
          or ss_wholesale_cost between 22 and 22+20)) B6
limit 100;
select
     i_item_id
    ,i_item_desc
    ,s_store_id
    ,s_store_name
    ,stddev_samp(ss_quantity)        as store_sales_quantity
    ,stddev_samp(sr_return_quantity) as store_returns_quantity
    ,stddev_samp(cs_quantity)        as catalog_sales_quantity
 from
    store_sales
   ,store_returns
   ,catalog_sales
   ,date_dim             d1
   ,date_dim             d2
   ,date_dim             d3
   ,store
   ,item
 where
     d1.d_moy               = 4
 and d1.d_year              = 1998
 and d1.d_date_sk           = ss_sold_date_sk
 and i_item_sk              = ss_item_sk
 and s_store_sk             = ss_store_sk
 and ss_customer_sk         = sr_customer_sk
 and ss_item_sk             = sr_item_sk
 and ss_ticket_number       = sr_ticket_number
 and sr_returned_date_sk    = d2.d_date_sk
 and d2.d_moy               between 4 and  4 + 3
 and d2.d_year              = 1998
 and sr_customer_sk         = cs_bill_customer_sk
 and sr_item_sk             = cs_item_sk
 and cs_sold_date_sk        = d3.d_date_sk
 and d3.d_year              in (1998,1998+1,1998+2)
 group by
    i_item_id
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 order by
    i_item_id
   ,i_item_desc
   ,s_store_id
   ,s_store_name
 limit 100;
with customer_total_return as
 (select wr_returning_customer_sk as ctr_customer_sk
        ,ca_state as ctr_state,
 	sum(wr_return_amt) as ctr_total_return
 from web_returns
     ,date_dim
     ,customer_address
 where wr_returned_date_sk = d_date_sk
   and d_year =2000
   and wr_returning_addr_sk = ca_address_sk
 group by wr_returning_customer_sk
         ,ca_state)
  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag
       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address
       ,c_last_review_date,ctr_total_return
 from customer_total_return ctr1
     ,customer_address
     ,customer
 where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
 			  from customer_total_return ctr2
                  	  where ctr1.ctr_state = ctr2.ctr_state)
       and ca_address_sk = c_current_addr_sk
       and ca_state = 'GA'
       and ctr1.ctr_customer_sk = c_customer_sk
 order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag
                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address
                  ,c_last_review_date,ctr_total_return
limit 100;
with ss as
 (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales
 from store_sales,date_dim,customer_address
 where ss_sold_date_sk = d_date_sk
  and ss_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year),
 ws as
 (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales
 from web_sales,date_dim,customer_address
 where ws_sold_date_sk = d_date_sk
  and ws_bill_addr_sk=ca_address_sk
 group by ca_county,d_qoy, d_year)
 select
        ss1.ca_county
       ,ss1.d_year
       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase
       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase
       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase
       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase
 from
        ss ss1
       ,ss ss2
       ,ss ss3
       ,ws ws1
       ,ws ws2
       ,ws ws3
 where
    ss1.d_qoy = 1
    and ss1.d_year = 1999
    and ss1.ca_county = ss2.ca_county
    and ss2.d_qoy = 2
    and ss2.d_year = 1999
 and ss2.ca_county = ss3.ca_county
    and ss3.d_qoy = 3
    and ss3.d_year = 1999
    and ss1.ca_county = ws1.ca_county
    and ws1.d_qoy = 1
    and ws1.d_year = 1999
    and ws1.ca_county = ws2.ca_county
    and ws2.d_qoy = 2
    and ws2.d_year = 1999
    and ws1.ca_county = ws3.ca_county
    and ws3.d_qoy = 3
    and ws3.d_year =1999
    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end
       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end
    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end
       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end
 order by ss1.d_year;
select  sum(cs_ext_discount_amt)  as "excess discount amount"
from
   catalog_sales
   ,item
   ,date_dim
where
   i_manufact_id = 66
   and i_item_sk = cs_item_sk
   and d_date between '2002-03-29' and
       (cast('2002-03-29' as date) + INTERVAL '90 days')
   and d_date_sk = cs_sold_date_sk
   and cs_ext_discount_amt > (
       select
           1.3 * avg(cs_ext_discount_amt)
       from
           catalog_sales
           ,date_dim
       where
           cs_item_sk = i_item_sk
           and d_date between '2002-03-29' and
                            (cast('2002-03-29' as date) + INTERVAL '90 days')
           and d_date_sk = cs_sold_date_sk
       )
limit 100;
with ss as (
 select
          i_manufact_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id in (select
  i_manufact_id
from
 item
where i_category in ('Home'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_manufact_id),
 cs as (
 select
          i_manufact_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id               in (select
  i_manufact_id
from
 item
where i_category in ('Home'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_manufact_id),
 ws as (
 select
          i_manufact_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_manufact_id               in (select
  i_manufact_id
from
 item
where i_category in ('Home'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 5
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_manufact_id)
  select  i_manufact_id ,sum(total_sales) total_sales
 from  (select * from ss
        union all
        select * from cs
        union all
        select * from ws) tmp1
 group by i_manufact_id
 order by total_sales
limit 100;
 select c_last_name
       ,c_first_name
       ,c_salutation
       ,c_preferred_cust_flag
       ,ss_ticket_number
       ,cnt from
   (select ss_ticket_number
          ,ss_customer_sk
          ,count(*) cnt
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)
    and (household_demographics.hd_buy_potential = '>10000' or
         household_demographics.hd_buy_potential = 'Unknown')
    and household_demographics.hd_vehicle_count > 0
    and (case when household_demographics.hd_vehicle_count > 0
	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count
	else null
	end)  > 1.2
    and date_dim.d_year in (2000,2000+1,2000+2)
    and store.s_county in ('Salem County','Terrell County','Arthur County','Oglethorpe County',
                           'Lunenburg County','Perry County','Halifax County','Sumner County')
    group by ss_ticket_number,ss_customer_sk) dn,customer
    where ss_customer_sk = c_customer_sk
      and cnt between 15 and 20
    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select
  ca_state,
  cd_gender,
  cd_marital_status,
  cd_dep_count,
  count(*) cnt1,
  avg(cd_dep_count),
  min(cd_dep_count),
  stddev_samp(cd_dep_count),
  cd_dep_employed_count,
  count(*) cnt2,
  avg(cd_dep_employed_count),
  min(cd_dep_employed_count),
  stddev_samp(cd_dep_employed_count),
  cd_dep_college_count,
  count(*) cnt3,
  avg(cd_dep_college_count),
  min(cd_dep_college_count),
  stddev_samp(cd_dep_college_count)
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2001 and
                d_qoy < 4) and
   (exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_qoy < 4) or
    exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2001 and
                  d_qoy < 4))
 group by ca_state,
          cd_gender,
          cd_marital_status,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 order by ca_state,
          cd_gender,
          cd_marital_status,
          cd_dep_count,
          cd_dep_employed_count,
          cd_dep_college_count
 limit 100;
select
    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin
   ,i_category
   ,i_class
   ,grouping(i_category)+grouping(i_class) as lochierarchy
   ,rank() over (
 	partition by grouping(i_category)+grouping(i_class),
 	case when grouping(i_class) = 0 then i_category end
 	order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent
 from
    store_sales
   ,date_dim       d1
   ,item
   ,store
 where
    d1.d_year = 1999
 and d1.d_date_sk = ss_sold_date_sk
 and i_item_sk  = ss_item_sk
 and s_store_sk  = ss_store_sk
 and s_state in ('IN','AL','MI','MN',
                 'TN','LA','FL','NM')
 group by rollup(i_category,i_class)
 order by
   lochierarchy desc
  ,case when lochierarchy = 0 then i_category end
  ,rank_within_parent
  limit 100;
select  i_item_id
       ,i_item_desc
       ,i_current_price
 from item, inventory, date_dim, catalog_sales
 where i_current_price between 39 and 39 + 30
 and inv_item_sk = i_item_sk
 and d_date_sk=inv_date_sk
 and d_date between cast('2001-01-16' as date) and (cast('2001-01-16' as date) +  INTERVAL '60 days')
 and i_manufact_id in (765,886,889,728)
 and inv_quantity_on_hand between 100 and 500
 and cs_item_sk = i_item_sk
 group by i_item_id,i_item_desc,i_current_price
 order by i_item_id
 limit 100;
select  count(*) from (
    select distinct c_last_name, c_first_name, d_date
    from store_sales, date_dim, customer
          where store_sales.ss_sold_date_sk = date_dim.d_date_sk
      and store_sales.ss_customer_sk = customer.c_customer_sk
      and d_month_seq between 1186 and 1186 + 11
  intersect
    select distinct c_last_name, c_first_name, d_date
    from catalog_sales, date_dim, customer
          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
      and d_month_seq between 1186 and 1186 + 11
  intersect
    select distinct c_last_name, c_first_name, d_date
    from web_sales, date_dim, customer
          where web_sales.ws_sold_date_sk = date_dim.d_date_sk
      and web_sales.ws_bill_customer_sk = customer.c_customer_sk
      and d_month_seq between 1186 and 1186 + 11
) hot_cust
limit 100;
with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2000
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end > 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=2
  and inv2.d_moy=2+1
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
select
   w_state
  ,i_item_id
  ,sum(case when (cast(d_date as date) < cast ('2000-03-18' as date))
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before
  ,sum(case when (cast(d_date as date) >= cast ('2000-03-18' as date))
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after
 from
   catalog_sales left outer join catalog_returns on
       (cs_order_number = cr_order_number
        and cs_item_sk = cr_item_sk)
  ,warehouse
  ,item
  ,date_dim
 where
     i_current_price between 0.99 and 1.49
 and i_item_sk          = cs_item_sk
 and cs_warehouse_sk    = w_warehouse_sk
 and cs_sold_date_sk    = d_date_sk
 and d_date between (cast ('2000-03-18' as date) - INTERVAL '30 days')
                and (cast ('2000-03-18' as date) + INTERVAL '30 days')
 group by
    w_state,i_item_id
 order by w_state,i_item_id
limit 100;
select  distinct(i_product_name)
 from item i1
 where i_manufact_id between 970 and 970+40
   and (select count(*) as item_cnt
        from item
        where (i_manufact = i1.i_manufact and
        ((i_category = 'Women' and
        (i_color = 'frosted' or i_color = 'rose') and
        (i_units = 'Lb' or i_units = 'Gross') and
        (i_size = 'medium' or i_size = 'large')
        ) or
        (i_category = 'Women' and
        (i_color = 'chocolate' or i_color = 'black') and
        (i_units = 'Box' or i_units = 'Dram') and
        (i_size = 'economy' or i_size = 'petite')
        ) or
        (i_category = 'Men' and
        (i_color = 'slate' or i_color = 'magenta') and
        (i_units = 'Carton' or i_units = 'Bundle') and
        (i_size = 'N/A' or i_size = 'small')
        ) or
        (i_category = 'Men' and
        (i_color = 'cornflower' or i_color = 'firebrick') and
        (i_units = 'Pound' or i_units = 'Oz') and
        (i_size = 'medium' or i_size = 'large')
        ))) or
       (i_manufact = i1.i_manufact and
        ((i_category = 'Women' and
        (i_color = 'almond' or i_color = 'steel') and
        (i_units = 'Tsp' or i_units = 'Case') and
        (i_size = 'medium' or i_size = 'large')
        ) or
        (i_category = 'Women' and
        (i_color = 'purple' or i_color = 'aquamarine') and
        (i_units = 'Bunch' or i_units = 'Gram') and
        (i_size = 'economy' or i_size = 'petite')
        ) or
        (i_category = 'Men' and
        (i_color = 'lavender' or i_color = 'papaya') and
        (i_units = 'Pallet' or i_units = 'Cup') and
        (i_size = 'N/A' or i_size = 'small')
        ) or
        (i_category = 'Men' and
        (i_color = 'maroon' or i_color = 'cyan') and
        (i_units = 'Each' or i_units = 'N/A') and
        (i_size = 'medium' or i_size = 'large')
        )))) > 0
 order by i_product_name
 limit 100;
select  dt.d_year
 	,item.i_category_id
 	,item.i_category
 	,sum(ss_ext_sales_price)
 from 	date_dim dt
 	,store_sales
 	,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
 	and store_sales.ss_item_sk = item.i_item_sk
 	and item.i_manager_id = 1
 	and dt.d_moy=12
 	and dt.d_year=1998
 group by 	dt.d_year
 		,item.i_category_id
 		,item.i_category
 order by       sum(ss_ext_sales_price) desc,dt.d_year
 		,item.i_category_id
 		,item.i_category
limit 100 ;
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -6 and
       d_year = 2001
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100;
select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing
from(select *
     from (select item_sk,rank() over (order by rank_col asc) rnk
           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col
                 from store_sales ss1
                 where ss_store_sk = 366
                 group by ss_item_sk
                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col
                                                  from store_sales
                                                  where ss_store_sk = 366
                                                    and ss_cdemo_sk is null
                                                  group by ss_store_sk))V1)V11
     where rnk  < 11) asceding,
    (select *
     from (select item_sk,rank() over (order by rank_col desc) rnk
           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col
                 from store_sales ss1
                 where ss_store_sk = 366
                 group by ss_item_sk
                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col
                                                  from store_sales
                                                  where ss_store_sk = 366
                                                    and ss_cdemo_sk is null
                                                  group by ss_store_sk))V2)V21
     where rnk  < 11) descending,
item i1,
item i2
where asceding.rnk = descending.rnk
  and i1.i_item_sk=asceding.item_sk
  and i2.i_item_sk=descending.item_sk
order by asceding.rnk
limit 100;
select  ca_zip, ca_county, sum(ws_sales_price)
 from web_sales, customer, customer_address, date_dim, item
 where ws_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk
 	and ws_item_sk = i_item_sk
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')
 	      or
 	      i_item_id in (select i_item_id
                             from item
                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)
                             )
 	    )
 	and ws_sold_date_sk = d_date_sk
 	and d_qoy = 1 and d_year = 1998
 group by ca_zip, ca_county
 order by ca_zip, ca_county
 limit 100;
select  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,amt,profit
 from
   (select ss_ticket_number
          ,ss_customer_sk
          ,ca_city bought_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics,customer_address
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and store_sales.ss_addr_sk = customer_address.ca_address_sk
    and (household_demographics.hd_dep_count = 0 or
         household_demographics.hd_vehicle_count= 1)
    and date_dim.d_dow in (6,0)
    and date_dim.d_year in (2000,2000+1,2000+2)
    and store.s_city in ('Five Forks','Oakland','Fairview','Winchester','Farmington')
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr
    where ss_customer_sk = c_customer_sk
      and customer.c_current_addr_sk = current_addr.ca_address_sk
      and current_addr.ca_city <> bought_city
  order by c_last_name
          ,c_first_name
          ,ca_city
          ,bought_city
          ,ss_ticket_number
  limit 100;
with v1 as(
 select i_category, i_brand,
        s_store_name, s_company_name,
        d_year, d_moy,
        sum(ss_sales_price) sum_sales,
        avg(sum(ss_sales_price)) over
          (partition by i_category, i_brand,
                     s_store_name, s_company_name, d_year)
          avg_monthly_sales,
        rank() over
          (partition by i_category, i_brand,
                     s_store_name, s_company_name
           order by d_year, d_moy) rn
 from item, store_sales, date_dim, store
 where ss_item_sk = i_item_sk and
       ss_sold_date_sk = d_date_sk and
       ss_store_sk = s_store_sk and
       (
         d_year = 1999 or
         ( d_year = 1999-1 and d_moy =12) or
         ( d_year = 1999+1 and d_moy =1)
       )
 group by i_category, i_brand,
          s_store_name, s_company_name,
          d_year, d_moy),
 v2 as(
 select v1.s_store_name
        ,v1.d_year, v1.d_moy
        ,v1.avg_monthly_sales
        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum
 from v1, v1 v1_lag, v1 v1_lead
 where v1.i_category = v1_lag.i_category and
       v1.i_category = v1_lead.i_category and
       v1.i_brand = v1_lag.i_brand and
       v1.i_brand = v1_lead.i_brand and
       v1.s_store_name = v1_lag.s_store_name and
       v1.s_store_name = v1_lead.s_store_name and
       v1.s_company_name = v1_lag.s_company_name and
       v1.s_company_name = v1_lead.s_company_name and
       v1.rn = v1_lag.rn + 1 and
       v1.rn = v1_lead.rn - 1)
  select  *
 from v2
 where  d_year = 1999 and
        avg_monthly_sales > 0 and
        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
 order by sum_sales - avg_monthly_sales, sum_sales
 limit 100;
select sum (ss_quantity)
 from store_sales, store, customer_demographics, customer_address, date_dim
 where s_store_sk = ss_store_sk
 and  ss_sold_date_sk = d_date_sk and d_year = 1998
 and
 (
  (
   cd_demo_sk = ss_cdemo_sk
   and
   cd_marital_status = 'M'
   and
   cd_education_status = 'Unknown'
   and
   ss_sales_price between 100.00 and 150.00
   )
 or
  (
  cd_demo_sk = ss_cdemo_sk
   and
   cd_marital_status = 'W'
   and
   cd_education_status = 'College'
   and
   ss_sales_price between 50.00 and 100.00
  )
 or
 (
  cd_demo_sk = ss_cdemo_sk
  and
   cd_marital_status = 'D'
   and
   cd_education_status = 'Primary'
   and
   ss_sales_price between 150.00 and 200.00
 )
 )
 and
 (
  (
  ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('MI', 'GA', 'NH')
  and ss_net_profit between 0 and 2000
  )
 or
  (ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('TX', 'KY', 'SD')
  and ss_net_profit between 150 and 3000
  )
 or
  (ss_addr_sk = ca_address_sk
  and
  ca_country = 'United States'
  and
  ca_state in ('NY', 'OH', 'FL')
  and ss_net_profit between 50 and 25000
  )
 )
;
select  channel, item, return_ratio, return_rank, currency_rank from
 (select
 'web' as channel
 ,web.item
 ,web.return_ratio
 ,web.return_rank
 ,web.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select ws.ws_item_sk as item
 		,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/
 		cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		 web_sales ws left outer join web_returns wr
 			on (ws.ws_order_number = wr.wr_order_number and
 			ws.ws_item_sk = wr.wr_item_sk)
                 ,date_dim
 		where
 			wr.wr_return_amt > 10000
 			and ws.ws_net_profit > 1
                         and ws.ws_net_paid > 0
                         and ws.ws_quantity > 0
                         and ws_sold_date_sk = d_date_sk
                         and d_year = 2000
                         and d_moy = 12
 		group by ws.ws_item_sk
 	) in_web
 ) web
 where
 (
 web.return_rank <= 10
 or
 web.currency_rank <= 10
 )
 union
 select
 'catalog' as channel
 ,catalog.item
 ,catalog.return_ratio
 ,catalog.return_rank
 ,catalog.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select
 		cs.cs_item_sk as item
 		,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/
 		cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		catalog_sales cs left outer join catalog_returns cr
 			on (cs.cs_order_number = cr.cr_order_number and
 			cs.cs_item_sk = cr.cr_item_sk)
                ,date_dim
 		where
 			cr.cr_return_amount > 10000
 			and cs.cs_net_profit > 1
                         and cs.cs_net_paid > 0
                         and cs.cs_quantity > 0
                         and cs_sold_date_sk = d_date_sk
                         and d_year = 2000
                         and d_moy = 12
                 group by cs.cs_item_sk
 	) in_cat
 ) catalog
 where
 (
 catalog.return_rank <= 10
 or
 catalog.currency_rank <=10
 )
 union
 select
 'store' as channel
 ,store.item
 ,store.return_ratio
 ,store.return_rank
 ,store.currency_rank
 from (
 	select
 	 item
 	,return_ratio
 	,currency_ratio
 	,rank() over (order by return_ratio) as return_rank
 	,rank() over (order by currency_ratio) as currency_rank
 	from
 	(	select sts.ss_item_sk as item
 		,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio
 		,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio
 		from
 		store_sales sts left outer join store_returns sr
 			on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)
                ,date_dim
 		where
 			sr.sr_return_amt > 10000
 			and sts.ss_net_profit > 1
                         and sts.ss_net_paid > 0
                         and sts.ss_quantity > 0
                         and ss_sold_date_sk = d_date_sk
                         and d_year = 2000
                         and d_moy = 12
 		group by sts.ss_item_sk
 	) in_store
 ) store
 where  (
 store.return_rank <= 10
 or
 store.currency_rank <= 10
 )
 )
 order by 1,4,5,2
 limit 100;
select  dt.d_year
 	,item.i_brand_id brand_id
 	,item.i_brand brand
 	,sum(ss_ext_sales_price) ext_price
 from date_dim dt
     ,store_sales
     ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
    and store_sales.ss_item_sk = item.i_item_sk
    and item.i_manager_id = 1
    and dt.d_moy=12
    and dt.d_year=2000
 group by dt.d_year
 	,item.i_brand
 	,item.i_brand_id
 order by dt.d_year
 	,ext_price desc
 	,brand_id
limit 100 ;
select  * from
(select i_manufact_id,
sum(ss_sales_price) sum_sales,
avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales
from item, store_sales, date_dim, store
where ss_item_sk = i_item_sk and
ss_sold_date_sk = d_date_sk and
ss_store_sk = s_store_sk and
d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and
((i_category in ('Books','Children','Electronics') and
i_class in ('personal','portable','reference','self-help') and
i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',
		'exportiunivamalg #9','scholaramalgamalg #9'))
or(i_category in ('Women','Music','Men') and
i_class in ('accessories','classical','fragrances','pants') and
i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',
		'importoamalg #1')))
group by i_manufact_id, d_qoy ) tmp1
where case when avg_quarterly_sales > 0
	then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales
	else null end > 0.1
order by avg_quarterly_sales,
	 sum_sales,
	 i_manufact_id
limit 100;
with my_customers as (
 select distinct c_customer_sk
        , c_current_addr_sk
 from
        ( select cs_sold_date_sk sold_date_sk,
                 cs_bill_customer_sk customer_sk,
                 cs_item_sk item_sk
          from   catalog_sales
          union all
          select ws_sold_date_sk sold_date_sk,
                 ws_bill_customer_sk customer_sk,
                 ws_item_sk item_sk
          from   web_sales
         ) cs_or_ws_sales,
         item,
         date_dim,
         customer
 where   sold_date_sk = d_date_sk
         and item_sk = i_item_sk
         and i_category = 'Books'
         and i_class = 'business'
         and c_customer_sk = cs_or_ws_sales.customer_sk
         and d_moy = 2
         and d_year = 2000
 )
 , my_revenue as (
 select c_customer_sk,
        sum(ss_ext_sales_price) as revenue
 from   my_customers,
        store_sales,
        customer_address,
        store,
        date_dim
 where  c_current_addr_sk = ca_address_sk
        and ca_county = s_county
        and ca_state = s_state
        and ss_sold_date_sk = d_date_sk
        and c_customer_sk = ss_customer_sk
        and d_month_seq between (select distinct d_month_seq+1
                                 from   date_dim where d_year = 2000 and d_moy = 2)
                           and  (select distinct d_month_seq+3
                                 from   date_dim where d_year = 2000 and d_moy = 2)
 group by c_customer_sk
 )
 , segments as
 (select cast((revenue/50) as int) as segment
  from   my_revenue
 )
  select  segment, count(*) as num_customers, segment*50 as segment_base
 from segments
 group by segment
 order by segment, num_customers
 limit 100;
select  i_brand_id brand_id, i_brand brand,
 	sum(ss_ext_sales_price) ext_price
 from date_dim, store_sales, item
 where d_date_sk = ss_sold_date_sk
 	and ss_item_sk = i_item_sk
 	and i_manager_id=13
 	and d_moy=11
 	and d_year=1999
 group by i_brand, i_brand_id
 order by ext_price desc, i_brand_id
limit 100 ;
with ss as (
 select i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where i_item_id in (select
     i_item_id
from item
where i_color in ('chiffon','smoke','lace'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 5
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id),
 cs as (
 select i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('chiffon','smoke','lace'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 5
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id),
 ws as (
 select i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from item
where i_color in ('chiffon','smoke','lace'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 2001
 and     d_moy                   = 5
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -6
 group by i_item_id)
  select  i_item_id ,sum(total_sales) total_sales
 from  (select * from ss
        union all
        select * from cs
        union all
        select * from ws) tmp1
 group by i_item_id
 order by total_sales,
          i_item_id
 limit 100;
with v1 as(
 select i_category, i_brand,
        cc_name,
        d_year, d_moy,
        sum(cs_sales_price) sum_sales,
        avg(sum(cs_sales_price)) over
          (partition by i_category, i_brand,
                     cc_name, d_year)
          avg_monthly_sales,
        rank() over
          (partition by i_category, i_brand,
                     cc_name
           order by d_year, d_moy) rn
 from item, catalog_sales, date_dim, call_center
 where cs_item_sk = i_item_sk and
       cs_sold_date_sk = d_date_sk and
       cc_call_center_sk= cs_call_center_sk and
       (
         d_year = 1999 or
         ( d_year = 1999-1 and d_moy =12) or
         ( d_year = 1999+1 and d_moy =1)
       )
 group by i_category, i_brand,
          cc_name , d_year, d_moy),
 v2 as(
 select v1.i_category, v1.i_brand
        ,v1.d_year, v1.d_moy
        ,v1.avg_monthly_sales
        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum
 from v1, v1 v1_lag, v1 v1_lead
 where v1.i_category = v1_lag.i_category and
       v1.i_category = v1_lead.i_category and
       v1.i_brand = v1_lag.i_brand and
       v1.i_brand = v1_lead.i_brand and
       v1. cc_name = v1_lag. cc_name and
       v1. cc_name = v1_lead. cc_name and
       v1.rn = v1_lag.rn + 1 and
       v1.rn = v1_lead.rn - 1)
  select  *
 from v2
 where  d_year = 1999 and
        avg_monthly_sales > 0 and
        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
 order by sum_sales - avg_monthly_sales, avg_monthly_sales
 limit 100;
with ss_items as
 (select i_item_id item_id
        ,sum(ss_ext_sales_price) ss_item_rev
 from store_sales
     ,item
     ,date_dim
 where ss_item_sk = i_item_sk
   and d_date in (select d_date
                  from date_dim
                  where d_week_seq = (select d_week_seq
                                      from date_dim
                                      where d_date = '1998-02-21'))
   and ss_sold_date_sk   = d_date_sk
 group by i_item_id),
 cs_items as
 (select i_item_id item_id
        ,sum(cs_ext_sales_price) cs_item_rev
  from catalog_sales
      ,item
      ,date_dim
 where cs_item_sk = i_item_sk
  and  d_date in (select d_date
                  from date_dim
                  where d_week_seq = (select d_week_seq
                                      from date_dim
                                      where d_date = '1998-02-21'))
  and  cs_sold_date_sk = d_date_sk
 group by i_item_id),
 ws_items as
 (select i_item_id item_id
        ,sum(ws_ext_sales_price) ws_item_rev
  from web_sales
      ,item
      ,date_dim
 where ws_item_sk = i_item_sk
  and  d_date in (select d_date
                  from date_dim
                  where d_week_seq =(select d_week_seq
                                     from date_dim
                                     where d_date = '1998-02-21'))
  and ws_sold_date_sk   = d_date_sk
 group by i_item_id)
  select  ss_items.item_id
       ,ss_item_rev
       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev
       ,cs_item_rev
       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev
       ,ws_item_rev
       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev
       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average
 from ss_items,cs_items,ws_items
 where ss_items.item_id=cs_items.item_id
   and ss_items.item_id=ws_items.item_id
   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev
   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev
   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev
   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev
   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev
   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev
 order by item_id
         ,ss_item_rev
 limit 100;
with wss as
 (select d_week_seq,
        ss_store_sk,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from store_sales,date_dim
 where d_date_sk = ss_sold_date_sk
 group by d_week_seq,ss_store_sk
 )
  select  s_store_name1,s_store_id1,d_week_seq1
       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2
       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2
       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2
 from
 (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1
        ,s_store_id s_store_id1,sun_sales sun_sales1
        ,mon_sales mon_sales1,tue_sales tue_sales1
        ,wed_sales wed_sales1,thu_sales thu_sales1
        ,fri_sales fri_sales1,sat_sales sat_sales1
  from wss,store,date_dim d
  where d.d_week_seq = wss.d_week_seq and
        ss_store_sk = s_store_sk and
        d_month_seq between 1205 and 1205 + 11) y,
 (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2
        ,s_store_id s_store_id2,sun_sales sun_sales2
        ,mon_sales mon_sales2,tue_sales tue_sales2
        ,wed_sales wed_sales2,thu_sales thu_sales2
        ,fri_sales fri_sales2,sat_sales sat_sales2
  from wss,store,date_dim d
  where d.d_week_seq = wss.d_week_seq and
        ss_store_sk = s_store_sk and
        d_month_seq between 1205+ 12 and 1205 + 23) x
 where s_store_id1=s_store_id2
   and d_week_seq1=d_week_seq2-52
 order by s_store_name1,s_store_id1,d_week_seq1
limit 100;
with ss as (
 select
          i_item_id,sum(ss_ext_sales_price) total_sales
 from
 	store_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id in (select
  i_item_id
from
 item
where i_category in ('Children'))
 and     ss_item_sk              = i_item_sk
 and     ss_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 10
 and     ss_addr_sk              = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id),
 cs as (
 select
          i_item_id,sum(cs_ext_sales_price) total_sales
 from
 	catalog_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Children'))
 and     cs_item_sk              = i_item_sk
 and     cs_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 10
 and     cs_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id),
 ws as (
 select
          i_item_id,sum(ws_ext_sales_price) total_sales
 from
 	web_sales,
 	date_dim,
         customer_address,
         item
 where
         i_item_id               in (select
  i_item_id
from
 item
where i_category in ('Children'))
 and     ws_item_sk              = i_item_sk
 and     ws_sold_date_sk         = d_date_sk
 and     d_year                  = 1998
 and     d_moy                   = 10
 and     ws_bill_addr_sk         = ca_address_sk
 and     ca_gmt_offset           = -5
 group by i_item_id)
  select
  i_item_id
,sum(total_sales) total_sales
 from  (select * from ss
        union all
        select * from cs
        union all
        select * from ws) tmp1
 group by i_item_id
 order by i_item_id
      ,total_sales
 limit 100;
select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100
from
  (select sum(ss_ext_sales_price) promotions
   from  store_sales
        ,store
        ,promotion
        ,date_dim
        ,customer
        ,customer_address
        ,item
   where ss_sold_date_sk = d_date_sk
   and   ss_store_sk = s_store_sk
   and   ss_promo_sk = p_promo_sk
   and   ss_customer_sk= c_customer_sk
   and   ca_address_sk = c_current_addr_sk
   and   ss_item_sk = i_item_sk
   and   ca_gmt_offset = -6
   and   i_category = 'Sports'
   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')
   and   s_gmt_offset = -6
   and   d_year = 2001
   and   d_moy  = 12) promotional_sales,
  (select sum(ss_ext_sales_price) total
   from  store_sales
        ,store
        ,date_dim
        ,customer
        ,customer_address
        ,item
   where ss_sold_date_sk = d_date_sk
   and   ss_store_sk = s_store_sk
   and   ss_customer_sk= c_customer_sk
   and   ca_address_sk = c_current_addr_sk
   and   ss_item_sk = i_item_sk
   and   ca_gmt_offset = -6
   and   i_category = 'Sports'
   and   s_gmt_offset = -6
   and   d_year = 2001
   and   d_moy  = 12) all_sales
order by promotions, total
limit 100;
select
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,web_name
  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as "30 days"
  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and
                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as "31-60 days"
  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and
                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as "61-90 days"
  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and
                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as "91-120 days"
  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as ">120 days"
from
   web_sales
  ,warehouse
  ,ship_mode
  ,web_site
  ,date_dim
where
    d_month_seq between 1215 and 1215 + 11
and ws_ship_date_sk   = d_date_sk
and ws_warehouse_sk   = w_warehouse_sk
and ws_ship_mode_sk   = sm_ship_mode_sk
and ws_web_site_sk    = web_site_sk
group by
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,web_name
order by substr(w_warehouse_name,1,20)
        ,sm_type
       ,web_name
limit 100;
select  *
from (select i_manager_id
             ,sum(ss_sales_price) sum_sales
             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales
      from item
          ,store_sales
          ,date_dim
          ,store
      where ss_item_sk = i_item_sk
        and ss_sold_date_sk = d_date_sk
        and ss_store_sk = s_store_sk
        and d_month_seq in (1211,1211+1,1211+2,1211+3,1211+4,1211+5,1211+6,1211+7,1211+8,1211+9,1211+10,1211+11)
        and ((    i_category in ('Books','Children','Electronics')
              and i_class in ('personal','portable','reference','self-help')
              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',
		                  'exportiunivamalg #9','scholaramalgamalg #9'))
           or(    i_category in ('Women','Music','Men')
              and i_class in ('accessories','classical','fragrances','pants')
              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',
		                 'importoamalg #1')))
group by i_manager_id, d_moy) tmp1
where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1
order by i_manager_id
        ,avg_monthly_sales
        ,sum_sales
limit 100;
with cs_ui as
 (select cs_item_sk
        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund
  from catalog_sales
      ,catalog_returns
  where cs_item_sk = cr_item_sk
    and cs_order_number = cr_order_number
  group by cs_item_sk
  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),
cross_sales as
 (select i_product_name product_name
     ,i_item_sk item_sk
     ,s_store_name store_name
     ,s_zip store_zip
     ,ad1.ca_street_number b_street_number
     ,ad1.ca_street_name b_street_name
     ,ad1.ca_city b_city
     ,ad1.ca_zip b_zip
     ,ad2.ca_street_number c_street_number
     ,ad2.ca_street_name c_street_name
     ,ad2.ca_city c_city
     ,ad2.ca_zip c_zip
     ,d1.d_year as syear
     ,d2.d_year as fsyear
     ,d3.d_year s2year
     ,count(*) cnt
     ,sum(ss_wholesale_cost) s1
     ,sum(ss_list_price) s2
     ,sum(ss_coupon_amt) s3
  FROM   store_sales
        ,store_returns
        ,cs_ui
        ,date_dim d1
        ,date_dim d2
        ,date_dim d3
        ,store
        ,customer
        ,customer_demographics cd1
        ,customer_demographics cd2
        ,promotion
        ,household_demographics hd1
        ,household_demographics hd2
        ,customer_address ad1
        ,customer_address ad2
        ,income_band ib1
        ,income_band ib2
        ,item
  WHERE  ss_store_sk = s_store_sk AND
         ss_sold_date_sk = d1.d_date_sk AND
         ss_customer_sk = c_customer_sk AND
         ss_cdemo_sk= cd1.cd_demo_sk AND
         ss_hdemo_sk = hd1.hd_demo_sk AND
         ss_addr_sk = ad1.ca_address_sk and
         ss_item_sk = i_item_sk and
         ss_item_sk = sr_item_sk and
         ss_ticket_number = sr_ticket_number and
         ss_item_sk = cs_ui.cs_item_sk and
         c_current_cdemo_sk = cd2.cd_demo_sk AND
         c_current_hdemo_sk = hd2.hd_demo_sk AND
         c_current_addr_sk = ad2.ca_address_sk and
         c_first_sales_date_sk = d2.d_date_sk and
         c_first_shipto_date_sk = d3.d_date_sk and
         ss_promo_sk = p_promo_sk and
         hd1.hd_income_band_sk = ib1.ib_income_band_sk and
         hd2.hd_income_band_sk = ib2.ib_income_band_sk and
         cd1.cd_marital_status <> cd2.cd_marital_status and
         i_color in ('azure','gainsboro','misty','blush','hot','lemon') and
         i_current_price between 80 and 80 + 10 and
         i_current_price between 80 + 1 and 80 + 15
group by i_product_name
       ,i_item_sk
       ,s_store_name
       ,s_zip
       ,ad1.ca_street_number
       ,ad1.ca_street_name
       ,ad1.ca_city
       ,ad1.ca_zip
       ,ad2.ca_street_number
       ,ad2.ca_street_name
       ,ad2.ca_city
       ,ad2.ca_zip
       ,d1.d_year
       ,d2.d_year
       ,d3.d_year
)
select cs1.product_name
     ,cs1.store_name
     ,cs1.store_zip
     ,cs1.b_street_number
     ,cs1.b_street_name
     ,cs1.b_city
     ,cs1.b_zip
     ,cs1.c_street_number
     ,cs1.c_street_name
     ,cs1.c_city
     ,cs1.c_zip
     ,cs1.syear
     ,cs1.cnt
     ,cs1.s1 as s11
     ,cs1.s2 as s21
     ,cs1.s3 as s31
     ,cs2.s1 as s12
     ,cs2.s2 as s22
     ,cs2.s3 as s32
     ,cs2.syear
     ,cs2.cnt
from cross_sales cs1,cross_sales cs2
where cs1.item_sk=cs2.item_sk and
     cs1.syear = 1999 and
     cs2.syear = 1999 + 1 and
     cs2.cnt <= cs1.cnt and
     cs1.store_name = cs2.store_name and
     cs1.store_zip = cs2.store_zip
order by cs1.product_name
       ,cs1.store_name
       ,cs2.cnt
       ,cs1.s1
       ,cs2.s1;
select
	s_store_name,
	i_item_desc,
	sc.revenue,
	i_current_price,
	i_wholesale_cost,
	i_brand
 from store, item,
     (select ss_store_sk, avg(revenue) as ave
 	from
 	    (select  ss_store_sk, ss_item_sk,
 		     sum(ss_sales_price) as revenue
 		from store_sales, date_dim
 		where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11
 		group by ss_store_sk, ss_item_sk) sa
 	group by ss_store_sk) sb,
     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue
 	from store_sales, date_dim
 	where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11
 	group by ss_store_sk, ss_item_sk) sc
 where sb.ss_store_sk = sc.ss_store_sk and
       sc.revenue <= 0.1 * sb.ave and
       s_store_sk = sc.ss_store_sk and
       i_item_sk = sc.ss_item_sk
 order by s_store_name, i_item_desc
limit 100;
select
         w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
        ,ship_carriers
        ,year
 	,sum(jan_sales) as jan_sales
 	,sum(feb_sales) as feb_sales
 	,sum(mar_sales) as mar_sales
 	,sum(apr_sales) as apr_sales
 	,sum(may_sales) as may_sales
 	,sum(jun_sales) as jun_sales
 	,sum(jul_sales) as jul_sales
 	,sum(aug_sales) as aug_sales
 	,sum(sep_sales) as sep_sales
 	,sum(oct_sales) as oct_sales
 	,sum(nov_sales) as nov_sales
 	,sum(dec_sales) as dec_sales
 	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot
 	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot
 	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot
 	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot
 	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot
 	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot
 	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot
 	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot
 	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot
 	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot
 	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot
 	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot
 	,sum(jan_net) as jan_net
 	,sum(feb_net) as feb_net
 	,sum(mar_net) as mar_net
 	,sum(apr_net) as apr_net
 	,sum(may_net) as may_net
 	,sum(jun_net) as jun_net
 	,sum(jul_net) as jul_net
 	,sum(aug_net) as aug_net
 	,sum(sep_net) as sep_net
 	,sum(oct_net) as oct_net
 	,sum(nov_net) as nov_net
 	,sum(dec_net) as dec_net
 from (
     select
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'MSC' || ',' || 'GERMA' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1
 		then ws_sales_price* ws_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2
 		then ws_sales_price* ws_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3
 		then ws_sales_price* ws_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4
 		then ws_sales_price* ws_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5
 		then ws_sales_price* ws_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6
 		then ws_sales_price* ws_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7
 		then ws_sales_price* ws_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8
 		then ws_sales_price* ws_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9
 		then ws_sales_price* ws_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10
 		then ws_sales_price* ws_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then ws_sales_price* ws_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then ws_sales_price* ws_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net
     from
          web_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	  ,ship_mode
     where
            ws_warehouse_sk =  w_warehouse_sk
        and ws_sold_date_sk = d_date_sk
        and ws_sold_time_sk = t_time_sk
 	and ws_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2001
 	and t_time between 9453 and 9453+28800
 	and sm_carrier in ('MSC','GERMA')
     group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 union all
     select
 	w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,'MSC' || ',' || 'GERMA' as ship_carriers
       ,d_year as year
 	,sum(case when d_moy = 1
 		then cs_ext_list_price* cs_quantity else 0 end) as jan_sales
 	,sum(case when d_moy = 2
 		then cs_ext_list_price* cs_quantity else 0 end) as feb_sales
 	,sum(case when d_moy = 3
 		then cs_ext_list_price* cs_quantity else 0 end) as mar_sales
 	,sum(case when d_moy = 4
 		then cs_ext_list_price* cs_quantity else 0 end) as apr_sales
 	,sum(case when d_moy = 5
 		then cs_ext_list_price* cs_quantity else 0 end) as may_sales
 	,sum(case when d_moy = 6
 		then cs_ext_list_price* cs_quantity else 0 end) as jun_sales
 	,sum(case when d_moy = 7
 		then cs_ext_list_price* cs_quantity else 0 end) as jul_sales
 	,sum(case when d_moy = 8
 		then cs_ext_list_price* cs_quantity else 0 end) as aug_sales
 	,sum(case when d_moy = 9
 		then cs_ext_list_price* cs_quantity else 0 end) as sep_sales
 	,sum(case when d_moy = 10
 		then cs_ext_list_price* cs_quantity else 0 end) as oct_sales
 	,sum(case when d_moy = 11
 		then cs_ext_list_price* cs_quantity else 0 end) as nov_sales
 	,sum(case when d_moy = 12
 		then cs_ext_list_price* cs_quantity else 0 end) as dec_sales
 	,sum(case when d_moy = 1
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net
 	,sum(case when d_moy = 2
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net
 	,sum(case when d_moy = 3
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net
 	,sum(case when d_moy = 4
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net
 	,sum(case when d_moy = 5
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net
 	,sum(case when d_moy = 6
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net
 	,sum(case when d_moy = 7
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net
 	,sum(case when d_moy = 8
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net
 	,sum(case when d_moy = 9
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net
 	,sum(case when d_moy = 10
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net
 	,sum(case when d_moy = 11
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net
 	,sum(case when d_moy = 12
 		then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net
     from
          catalog_sales
         ,warehouse
         ,date_dim
         ,time_dim
 	 ,ship_mode
     where
            cs_warehouse_sk =  w_warehouse_sk
        and cs_sold_date_sk = d_date_sk
        and cs_sold_time_sk = t_time_sk
 	and cs_ship_mode_sk = sm_ship_mode_sk
        and d_year = 2001
 	and t_time between 9453 AND 9453+28800
 	and sm_carrier in ('MSC','GERMA')
     group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
       ,d_year
 ) x
 group by
        w_warehouse_name
 	,w_warehouse_sq_ft
 	,w_city
 	,w_county
 	,w_state
 	,w_country
 	,ship_carriers
       ,year
 order by w_warehouse_name
 limit 100;
select  *
from (select i_category
            ,i_class
            ,i_brand
            ,i_product_name
            ,d_year
            ,d_qoy
            ,d_moy
            ,s_store_id
            ,sumsales
            ,rank() over (partition by i_category order by sumsales desc) rk
      from (select i_category
                  ,i_class
                  ,i_brand
                  ,i_product_name
                  ,d_year
                  ,d_qoy
                  ,d_moy
                  ,s_store_id
                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales
            from store_sales
                ,date_dim
                ,store
                ,item
       where  ss_sold_date_sk=d_date_sk
          and ss_item_sk=i_item_sk
          and ss_store_sk = s_store_sk
          and d_month_seq between 1185 and 1185+11
       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2
where rk <= 100
order by i_category
        ,i_class
        ,i_brand
        ,i_product_name
        ,d_year
        ,d_qoy
        ,d_moy
        ,s_store_id
        ,sumsales
        ,rk
limit 100;
select  c_last_name
       ,c_first_name
       ,ca_city
       ,bought_city
       ,ss_ticket_number
       ,extended_price
       ,extended_tax
       ,list_price
 from (select ss_ticket_number
             ,ss_customer_sk
             ,ca_city bought_city
             ,sum(ss_ext_sales_price) extended_price
             ,sum(ss_ext_list_price) list_price
             ,sum(ss_ext_tax) extended_tax
       from store_sales
           ,date_dim
           ,store
           ,household_demographics
           ,customer_address
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_store_sk = store.s_store_sk
        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
        and store_sales.ss_addr_sk = customer_address.ca_address_sk
        and date_dim.d_dom between 1 and 2
        and (household_demographics.hd_dep_count = 4 or
             household_demographics.hd_vehicle_count= 0)
        and date_dim.d_year in (1999,1999+1,1999+2)
        and store.s_city in ('Pleasant Hill','Bethel')
       group by ss_ticket_number
               ,ss_customer_sk
               ,ss_addr_sk,ca_city) dn
      ,customer
      ,customer_address current_addr
 where ss_customer_sk = c_customer_sk
   and customer.c_current_addr_sk = current_addr.ca_address_sk
   and current_addr.ca_city <> bought_city
 order by c_last_name
         ,ss_ticket_number
 limit 100;
select
  cd_gender,
  cd_marital_status,
  cd_education_status,
  count(*) cnt1,
  cd_purchase_estimate,
  count(*) cnt2,
  cd_credit_rating,
  count(*) cnt3
 from
  customer c,customer_address ca,customer_demographics
 where
  c.c_current_addr_sk = ca.ca_address_sk and
  ca_state in ('MO','MN','AZ') and
  cd_demo_sk = c.c_current_cdemo_sk and
  exists (select *
          from store_sales,date_dim
          where c.c_customer_sk = ss_customer_sk and
                ss_sold_date_sk = d_date_sk and
                d_year = 2003 and
                d_moy between 2 and 2+2) and
   (not exists (select *
            from web_sales,date_dim
            where c.c_customer_sk = ws_bill_customer_sk and
                  ws_sold_date_sk = d_date_sk and
                  d_year = 2003 and
                  d_moy between 2 and 2+2) and
    not exists (select *
            from catalog_sales,date_dim
            where c.c_customer_sk = cs_ship_customer_sk and
                  cs_sold_date_sk = d_date_sk and
                  d_year = 2003 and
                  d_moy between 2 and 2+2))
 group by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 order by cd_gender,
          cd_marital_status,
          cd_education_status,
          cd_purchase_estimate,
          cd_credit_rating
 limit 100;
select
    sum(ss_net_profit) as total_sum
   ,s_state
   ,s_county
   ,grouping(s_state)+grouping(s_county) as lochierarchy
   ,rank() over (
 	partition by grouping(s_state)+grouping(s_county),
 	case when grouping(s_county) = 0 then s_state end
 	order by sum(ss_net_profit) desc) as rank_within_parent
 from
    store_sales
   ,date_dim       d1
   ,store
 where
    d1.d_month_seq between 1218 and 1218+11
 and d1.d_date_sk = ss_sold_date_sk
 and s_store_sk  = ss_store_sk
 and s_state in
             ( select s_state
               from  (select s_state as s_state,
 			    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking
                      from   store_sales, store, date_dim
                      where  d_month_seq between 1218 and 1218+11
 			    and d_date_sk = ss_sold_date_sk
 			    and s_store_sk  = ss_store_sk
                      group by s_state
                     ) tmp1
               where ranking <= 5
             )
 group by rollup(s_state,s_county)
 order by
   lochierarchy desc
  ,case when lochierarchy = 0 then s_state end
  ,rank_within_parent
 limit 100;
select i_brand_id brand_id, i_brand brand,t_hour,t_minute,
 	sum(ext_price) ext_price
 from item, (select ws_ext_sales_price as ext_price,
                        ws_sold_date_sk as sold_date_sk,
                        ws_item_sk as sold_item_sk,
                        ws_sold_time_sk as time_sk
                 from web_sales,date_dim
                 where d_date_sk = ws_sold_date_sk
                   and d_moy=12
                   and d_year=2000
                 union all
                 select cs_ext_sales_price as ext_price,
                        cs_sold_date_sk as sold_date_sk,
                        cs_item_sk as sold_item_sk,
                        cs_sold_time_sk as time_sk
                 from catalog_sales,date_dim
                 where d_date_sk = cs_sold_date_sk
                   and d_moy=12
                   and d_year=2000
                 union all
                 select ss_ext_sales_price as ext_price,
                        ss_sold_date_sk as sold_date_sk,
                        ss_item_sk as sold_item_sk,
                        ss_sold_time_sk as time_sk
                 from store_sales,date_dim
                 where d_date_sk = ss_sold_date_sk
                   and d_moy=12
                   and d_year=2000
                 ) tmp,time_dim
 where
   sold_item_sk = i_item_sk
   and i_manager_id=1
   and time_sk = t_time_sk
   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')
 group by i_brand, i_brand_id,t_hour,t_minute
 order by ext_price desc, i_brand_id
 ;
select  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '1001-5000'
  and d1.d_year = 2000
  and cd_marital_status = 'D'
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;
with year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,d_year as year
       ,sum(ss_net_paid) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
   and d_year in (1998,1998+1)
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,d_year as year
       ,sum(ws_net_paid) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
   and d_year in (1998,1998+1)
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,d_year
         )
  select
        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
         and t_s_firstyear.customer_id = t_w_secyear.customer_id
         and t_s_firstyear.customer_id = t_w_firstyear.customer_id
         and t_s_firstyear.sale_type = 's'
         and t_w_firstyear.sale_type = 'w'
         and t_s_secyear.sale_type = 's'
         and t_w_secyear.sale_type = 'w'
         and t_s_firstyear.year = 1998
         and t_s_secyear.year = 1998+1
         and t_w_firstyear.year = 1998
         and t_w_secyear.year = 1998+1
         and t_s_firstyear.year_total > 0
         and t_w_firstyear.year_total > 0
         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
 order by 3,1,2
limit 100;
WITH all_sales AS (
 SELECT d_year
       ,i_brand_id
       ,i_class_id
       ,i_category_id
       ,i_manufact_id
       ,SUM(sales_cnt) AS sales_cnt
       ,SUM(sales_amt) AS sales_amt
 FROM (SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk
                          JOIN date_dim ON d_date_sk=cs_sold_date_sk
                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number
                                                    AND cs_item_sk=cr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
       FROM store_sales JOIN item ON i_item_sk=ss_item_sk
                        JOIN date_dim ON d_date_sk=ss_sold_date_sk
                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number
                                                AND ss_item_sk=sr_item_sk)
       WHERE i_category='Sports'
       UNION
       SELECT d_year
             ,i_brand_id
             ,i_class_id
             ,i_category_id
             ,i_manufact_id
             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
       FROM web_sales JOIN item ON i_item_sk=ws_item_sk
                      JOIN date_dim ON d_date_sk=ws_sold_date_sk
                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number
                                            AND ws_item_sk=wr_item_sk)
       WHERE i_category='Sports') sales_detail
 GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
 SELECT  prev_yr.d_year AS prev_year
                          ,curr_yr.d_year AS year
                          ,curr_yr.i_brand_id
                          ,curr_yr.i_class_id
                          ,curr_yr.i_category_id
                          ,curr_yr.i_manufact_id
                          ,prev_yr.sales_cnt AS prev_yr_cnt
                          ,curr_yr.sales_cnt AS curr_yr_cnt
                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
 FROM all_sales curr_yr, all_sales prev_yr
 WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
   AND curr_yr.i_class_id=prev_yr.i_class_id
   AND curr_yr.i_category_id=prev_yr.i_category_id
   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
   AND curr_yr.d_year=2001
   AND prev_yr.d_year=2001-1
   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
 ORDER BY sales_cnt_diff,sales_amt_diff
 limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (
        SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price
         FROM store_sales, item, date_dim
         WHERE ss_customer_sk IS NULL
           AND ss_sold_date_sk=d_date_sk
           AND ss_item_sk=i_item_sk
        UNION ALL
        SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price
         FROM web_sales, item, date_dim
         WHERE ws_ship_addr_sk IS NULL
           AND ws_sold_date_sk=d_date_sk
           AND ws_item_sk=i_item_sk
        UNION ALL
        SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price
         FROM catalog_sales, item, date_dim
         WHERE cs_ship_mode_sk IS NULL
           AND cs_sold_date_sk=d_date_sk
           AND cs_item_sk=i_item_sk) foo
GROUP BY channel, col_name, d_year, d_qoy, i_category
ORDER BY channel, col_name, d_year, d_qoy, i_category
limit 100;
WITH ss AS (
  SELECT ss_store_sk,
         SUM(ss_ext_sales_price) AS sales,
         SUM(ss_net_profit) AS profit
  FROM store_sales
  JOIN date_dim ON ss_sold_date_sk = d_date_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY ss_store_sk
),
sr AS (
  SELECT sr_store_sk,
         SUM(sr_return_amt) AS "returns",
         SUM(sr_net_loss) AS profit_loss
  FROM store_returns
  JOIN date_dim ON sr_returned_date_sk = d_date_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY sr_store_sk
),
cs AS (
  SELECT cs_call_center_sk,
         SUM(cs_ext_sales_price) AS sales,
         SUM(cs_net_profit) AS profit
  FROM catalog_sales
  JOIN date_dim ON cs_sold_date_sk = d_date_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY cs_call_center_sk
),
cr AS (
  SELECT cr_call_center_sk,
         SUM(cr_return_amount) AS "returns",
         SUM(cr_net_loss) AS profit_loss
  FROM catalog_returns
  JOIN date_dim ON cr_returned_date_sk = d_date_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY cr_call_center_sk
),
ws AS (
  SELECT wp_web_page_sk,
         SUM(ws_ext_sales_price) AS sales,
         SUM(ws_net_profit) AS profit
  FROM web_sales
  JOIN date_dim ON ws_sold_date_sk = d_date_sk
  JOIN web_page ON ws_web_page_sk = wp_web_page_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY wp_web_page_sk
),
wr AS (
  SELECT wp_web_page_sk,
         SUM(wr_return_amt) AS "returns",
         SUM(wr_net_loss) AS profit_loss
  FROM web_returns
  JOIN date_dim ON wr_returned_date_sk = d_date_sk
  JOIN web_page ON wr_web_page_sk = wp_web_page_sk
  WHERE d_date BETWEEN CAST('2000-08-16' AS DATE)
                  AND (CAST('2000-08-16' AS DATE) + INTERVAL '30 days')
  GROUP BY wp_web_page_sk
)
SELECT channel,
       id,
       SUM(sales) AS sales,
       SUM("returns") AS "returns",
       SUM(profit) AS profit
FROM (
  SELECT 'store channel' AS channel,
         ss.ss_store_sk AS id,
         sales,
         COALESCE("returns", 0) AS "returns",
         (profit - COALESCE(profit_loss, 0)) AS profit
  FROM ss
  LEFT JOIN sr ON ss.ss_store_sk = sr.sr_store_sk
  UNION ALL
  SELECT 'catalog channel' AS channel,
         cs_call_center_sk AS id,
         sales,
         "returns",
         (profit - profit_loss) AS profit
  FROM cs, cr
  UNION ALL
  SELECT 'web channel' AS channel,
         ws.wp_web_page_sk AS id,
         sales,
         COALESCE("returns", 0) AS "returns",
         (profit - COALESCE(profit_loss, 0)) AS profit
  FROM ws
  LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk
) x
GROUP BY ROLLUP (channel, id)
ORDER BY channel, id
LIMIT 100;
WITH ws AS (
  SELECT d_year AS ws_sold_year, ws_item_sk,
    ws_bill_customer_sk ws_customer_sk,
    SUM(ws_quantity) ws_qty,
    SUM(ws_wholesale_cost) ws_wc,
    SUM(ws_sales_price) ws_sp
  FROM web_sales
  LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk
  JOIN date_dim ON ws_sold_date_sk = d_date_sk
  WHERE wr_order_number IS NULL
  GROUP BY d_year, ws_item_sk, ws_bill_customer_sk
),
cs AS (
  SELECT d_year AS cs_sold_year, cs_item_sk,
    cs_bill_customer_sk cs_customer_sk,
    SUM(cs_quantity) cs_qty,
    SUM(cs_wholesale_cost) cs_wc,
    SUM(cs_sales_price) cs_sp
  FROM catalog_sales
  LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk
  JOIN date_dim ON cs_sold_date_sk = d_date_sk
  WHERE cr_order_number IS NULL
  GROUP BY d_year, cs_item_sk, cs_bill_customer_sk
),
ss AS (
  SELECT d_year AS ss_sold_year, ss_item_sk,
    ss_customer_sk,
    SUM(ss_quantity) ss_qty,
    SUM(ss_wholesale_cost) ss_wc,
    SUM(ss_sales_price) ss_sp
  FROM store_sales
  LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk
  JOIN date_dim ON ss_sold_date_sk = d_date_sk
  WHERE sr_ticket_number IS NULL
  GROUP BY d_year, ss_item_sk, ss_customer_sk
)
SELECT
  ss_customer_sk,
  ROUND(ss_qty / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS "ratio",
  ss_qty AS store_qty,
  ss_wc AS store_wholesale_cost,
  ss_sp AS store_sales_price,
  COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty,
  COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost,
  COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price
FROM ss
LEFT JOIN ws ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk)
LEFT JOIN cs ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk)
WHERE (COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0) AND ss_sold_year = 2001
ORDER BY
  ss_customer_sk,
  ss_qty DESC, ss_wc DESC, ss_sp DESC,
  other_chan_qty,
  other_chan_wholesale_cost,
  other_chan_sales_price,
  "ratio"
LIMIT 100;
select
  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit
  from
   (select ss_ticket_number
          ,ss_customer_sk
          ,store.s_city
          ,sum(ss_coupon_amt) amt
          ,sum(ss_net_profit) profit
    from store_sales,date_dim,store,household_demographics
    where store_sales.ss_sold_date_sk = date_dim.d_date_sk
    and store_sales.ss_store_sk = store.s_store_sk
    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 3)
    and date_dim.d_dow = 1
    and date_dim.d_year in (1998,1998+1,1998+2)
    and store.s_number_employees between 200 and 295
    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer
    where ss_customer_sk = c_customer_sk
 order by c_last_name,c_first_name,substr(s_city,1,30), profit
limit 100;
with ssr as
 (select  s_store_id as store_id,
          sum(ss_ext_sales_price) as sales,
          sum(coalesce(sr_return_amt, 0)) as returns,
          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit
  from store_sales left outer join store_returns on
         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),
     date_dim,
     store,
     item,
     promotion
 where ss_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-06' as date)
                  and (cast('2002-08-06' as date) + INTERVAL '30 days')
       and ss_store_sk = s_store_sk
       and ss_item_sk = i_item_sk
       and i_current_price > 50
       and ss_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
 group by s_store_id)
 ,
 csr as
 (select  cp_catalog_page_id as catalog_page_id,
          sum(cs_ext_sales_price) as sales,
          sum(coalesce(cr_return_amount, 0)) as returns,
          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit
  from catalog_sales left outer join catalog_returns on
         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),
     date_dim,
     catalog_page,
     item,
     promotion
 where cs_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-06' as date)
                  and (cast('2002-08-06' as date) + INTERVAL '30 days')
        and cs_catalog_page_sk = cp_catalog_page_sk
       and cs_item_sk = i_item_sk
       and i_current_price > 50
       and cs_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by cp_catalog_page_id)
 ,
 wsr as
 (select  web_site_id,
          sum(ws_ext_sales_price) as sales,
          sum(coalesce(wr_return_amt, 0)) as returns,
          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit
  from web_sales left outer join web_returns on
         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),
     date_dim,
     web_site,
     item,
     promotion
 where ws_sold_date_sk = d_date_sk
       and d_date between cast('2002-08-06' as date)
                  and (cast('2002-08-06' as date) + INTERVAL '30 days')
        and ws_web_site_sk = web_site_sk
       and ws_item_sk = i_item_sk
       and i_current_price > 50
       and ws_promo_sk = p_promo_sk
       and p_channel_tv = 'N'
group by web_site_id)
  select  channel
        , id
        , sum(sales) as sales
        , sum(returns) as returns
        , sum(profit) as profit
 from
 (select 'store channel' as channel
        , 'store' || store_id as id
        , sales
        , returns
        , profit
 from   ssr
 union all
 select 'catalog channel' as channel
        , 'catalog_page' || catalog_page_id as id
        , sales
        , returns
        , profit
 from  csr
 union all
 select 'web channel' as channel
        , 'web_site' || web_site_id as id
        , sales
        , returns
        , profit
 from   wsr
 ) x
 group by rollup (channel, id)
 order by channel
         ,id
 limit 100;
with customer_total_return as
 (select cr_returning_customer_sk as ctr_customer_sk
        ,ca_state as ctr_state,
 	sum(cr_return_amt_inc_tax) as ctr_total_return
 from catalog_returns
     ,date_dim
     ,customer_address
 where cr_returned_date_sk = d_date_sk
   and d_year =1998
   and cr_returning_addr_sk = ca_address_sk
 group by cr_returning_customer_sk
         ,ca_state )
  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name
                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset
                  ,ca_location_type,ctr_total_return
 from customer_total_return ctr1
     ,customer_address
     ,customer
 where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
 			  from customer_total_return ctr2
                  	  where ctr1.ctr_state = ctr2.ctr_state)
       and ca_address_sk = c_current_addr_sk
       and ca_state = 'TX'
       and ctr1.ctr_customer_sk = c_customer_sk
 order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name
                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset
                  ,ca_location_type,ctr_total_return
 limit 100;
select  i_item_id
       ,i_item_desc
       ,i_current_price
 from item, inventory, date_dim, store_sales
 where i_current_price between 49 and 49+30
 and inv_item_sk = i_item_sk
 and d_date_sk=inv_date_sk
 and d_date between cast('2001-01-28' as date) and (cast('2001-01-28' as date) +  INTERVAL '60 days')
 and i_manufact_id in (80,675,292,17)
 and inv_quantity_on_hand between 100 and 500
 and ss_item_sk = i_item_sk
 group by i_item_id,i_item_desc,i_current_price
 order by i_item_id
 limit 100;
with sr_items as
 (select i_item_id item_id,
        sum(sr_return_quantity) sr_item_qty
 from store_returns,
      item,
      date_dim
 where sr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
	  where d_date in ('2000-06-17','2000-08-22','2000-11-17')))
 and   sr_returned_date_sk   = d_date_sk
 group by i_item_id),
 cr_items as
 (select i_item_id item_id,
        sum(cr_return_quantity) cr_item_qty
 from catalog_returns,
      item,
      date_dim
 where cr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
	  where d_date in ('2000-06-17','2000-08-22','2000-11-17')))
 and   cr_returned_date_sk   = d_date_sk
 group by i_item_id),
 wr_items as
 (select i_item_id item_id,
        sum(wr_return_quantity) wr_item_qty
 from web_returns,
      item,
      date_dim
 where wr_item_sk = i_item_sk
 and   d_date    in
	(select d_date
	from date_dim
	where d_week_seq in
		(select d_week_seq
		from date_dim
		where d_date in ('2000-06-17','2000-08-22','2000-11-17')))
 and   wr_returned_date_sk   = d_date_sk
 group by i_item_id)
  select  sr_items.item_id
       ,sr_item_qty
       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev
       ,cr_item_qty
       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev
       ,wr_item_qty
       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev
       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average
 from sr_items
     ,cr_items
     ,wr_items
 where sr_items.item_id=cr_items.item_id
   and sr_items.item_id=wr_items.item_id
 order by sr_items.item_id
         ,sr_item_qty
 limit 100;
select  c_customer_id as customer_id
       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername
 from customer
     ,customer_address
     ,customer_demographics
     ,household_demographics
     ,income_band
     ,store_returns
 where ca_city	        =  'Hopewell'
   and c_current_addr_sk = ca_address_sk
   and ib_lower_bound   >=  37855
   and ib_upper_bound   <=  37855 + 50000
   and ib_income_band_sk = hd_income_band_sk
   and cd_demo_sk = c_current_cdemo_sk
   and hd_demo_sk = c_current_hdemo_sk
   and sr_cdemo_sk = cd_demo_sk
 order by c_customer_id
 limit 100;
select  substr(r_reason_desc,1,20)
       ,avg(ws_quantity)
       ,avg(wr_refunded_cash)
       ,avg(wr_fee)
 from web_sales, web_returns, web_page, customer_demographics cd1,
      customer_demographics cd2, customer_address, date_dim, reason
 where ws_web_page_sk = wp_web_page_sk
   and ws_item_sk = wr_item_sk
   and ws_order_number = wr_order_number
   and ws_sold_date_sk = d_date_sk and d_year = 2001
   and cd1.cd_demo_sk = wr_refunded_cdemo_sk
   and cd2.cd_demo_sk = wr_returning_cdemo_sk
   and ca_address_sk = wr_refunded_addr_sk
   and r_reason_sk = wr_reason_sk
   and
   (
    (
     cd1.cd_marital_status = 'M'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = '4 yr Degree'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 100.00 and 150.00
    )
   or
    (
     cd1.cd_marital_status = 'S'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = 'College'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 50.00 and 100.00
    )
   or
    (
     cd1.cd_marital_status = 'D'
     and
     cd1.cd_marital_status = cd2.cd_marital_status
     and
     cd1.cd_education_status = 'Secondary'
     and
     cd1.cd_education_status = cd2.cd_education_status
     and
     ws_sales_price between 150.00 and 200.00
    )
   )
   and
   (
    (
     ca_country = 'United States'
     and
     ca_state in ('TX', 'VA', 'CA')
     and ws_net_profit between 100 and 200
    )
    or
    (
     ca_country = 'United States'
     and
     ca_state in ('AR', 'NE', 'MO')
     and ws_net_profit between 150 and 300
    )
    or
    (
     ca_country = 'United States'
     and
     ca_state in ('IA', 'MS', 'WA')
     and ws_net_profit between 50 and 250
    )
   )
group by r_reason_desc
order by substr(r_reason_desc,1,20)
        ,avg(ws_quantity)
        ,avg(wr_refunded_cash)
        ,avg(wr_fee)
limit 100;
select
    sum(ws_net_paid) as total_sum
   ,i_category
   ,i_class
   ,grouping(i_category)+grouping(i_class) as lochierarchy
   ,rank() over (
 	partition by grouping(i_category)+grouping(i_class),
 	case when grouping(i_class) = 0 then i_category end
 	order by sum(ws_net_paid) desc) as rank_within_parent
 from
    web_sales
   ,date_dim       d1
   ,item
 where
    d1.d_month_seq between 1215 and 1215+11
 and d1.d_date_sk = ws_sold_date_sk
 and i_item_sk  = ws_item_sk
 group by rollup(i_category,i_class)
 order by
   lochierarchy desc,
   case when lochierarchy = 0 then i_category end,
   rank_within_parent
 limit 100;
select count(*)
from ((select distinct c_last_name, c_first_name, d_date
       from store_sales, date_dim, customer
       where store_sales.ss_sold_date_sk = date_dim.d_date_sk
         and store_sales.ss_customer_sk = customer.c_customer_sk
         and d_month_seq between 1221 and 1221+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from catalog_sales, date_dim, customer
       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1221 and 1221+11)
       except
      (select distinct c_last_name, c_first_name, d_date
       from web_sales, date_dim, customer
       where web_sales.ws_sold_date_sk = date_dim.d_date_sk
         and web_sales.ws_bill_customer_sk = customer.c_customer_sk
         and d_month_seq between 1221 and 1221+11)
) cool_cust
;
select  *
from
 (select count(*) h8_30_to_9
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 8
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s1,
 (select count(*) h9_to_9_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s2,
 (select count(*) h9_30_to_10
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s3,
 (select count(*) h10_to_10_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s4,
 (select count(*) h10_30_to_11
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s5,
 (select count(*) h11_to_11_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s6,
 (select count(*) h11_30_to_12
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s7,
 (select count(*) h12_to_12_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 12
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 2 and household_demographics.hd_vehicle_count<=2+2) or
          (household_demographics.hd_dep_count = 4 and household_demographics.hd_vehicle_count<=4+2) or
          (household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2))
     and store.s_store_name = 'ese') s8
;
select  *
from(
select i_category, i_class, i_brand,
       s_store_name, s_company_name,
       d_moy,
       sum(ss_sales_price) sum_sales,
       avg(sum(ss_sales_price)) over
         (partition by i_category, i_brand, s_store_name, s_company_name)
         avg_monthly_sales
from item, store_sales, date_dim, store
where ss_item_sk = i_item_sk and
      ss_sold_date_sk = d_date_sk and
      ss_store_sk = s_store_sk and
      d_year in (2000) and
        ((i_category in ('Home','Music','Books') and
          i_class in ('glassware','classical','fiction')
         )
      or (i_category in ('Jewelry','Sports','Women') and
          i_class in ('semi-precious','baseball','dresses')
        ))
group by i_category, i_class, i_brand,
         s_store_name, s_company_name, d_moy) tmp1
where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1
order by sum_sales - avg_monthly_sales, s_store_name
limit 100;
SELECT
  CAST(amc AS decimal(15,4)) / NULLIF(CAST(pmc AS decimal(15,4)), 0) AS am_pm_ratio
FROM
  (SELECT count(*) amc
   FROM web_sales, household_demographics, time_dim, web_page
   WHERE ws_sold_time_sk = time_dim.t_time_sk
     AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk
     AND ws_web_page_sk = web_page.wp_web_page_sk
     AND time_dim.t_hour BETWEEN 9 AND 9 + 1
     AND household_demographics.hd_dep_count = 3
     AND web_page.wp_char_count BETWEEN 5000 AND 5200) at,
  (SELECT count(*) pmc
   FROM web_sales, household_demographics, time_dim, web_page
   WHERE ws_sold_time_sk = time_dim.t_time_sk
     AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk
     AND ws_web_page_sk = web_page.wp_web_page_sk
     AND time_dim.t_hour BETWEEN 16 AND 16 + 1
     AND household_demographics.hd_dep_count = 3
     AND web_page.wp_char_count BETWEEN 5000 AND 5200) pt
ORDER BY am_pm_ratio
LIMIT 100;
select
        cc_call_center_id Call_Center,
        cc_name Call_Center_Name,
        cc_manager Manager,
        sum(cr_net_loss) Returns_Loss
from
        call_center,
        catalog_returns,
        date_dim,
        customer,
        customer_address,
        customer_demographics,
        household_demographics
where
        cr_call_center_sk       = cc_call_center_sk
and     cr_returned_date_sk     = d_date_sk
and     cr_returning_customer_sk= c_customer_sk
and     cd_demo_sk              = c_current_cdemo_sk
and     hd_demo_sk              = c_current_hdemo_sk
and     ca_address_sk           = c_current_addr_sk
and     d_year                  = 2000
and     d_moy                   = 12
and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')
        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))
and     hd_buy_potential like 'Unknown%'
and     ca_gmt_offset           = -7
group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status
order by sum(cr_net_loss) desc;
select
   sum(ws_ext_discount_amt)  as "Excess Discount Amount"
from
    web_sales
   ,item
   ,date_dim
where
i_manufact_id = 356
and i_item_sk = ws_item_sk
and d_date between '2001-03-12' and
        (cast('2001-03-12' as date) + INTERVAL '90 days')
and d_date_sk = ws_sold_date_sk
and ws_ext_discount_amt
     > (
         SELECT
            1.3 * avg(ws_ext_discount_amt)
         FROM
            web_sales
           ,date_dim
         WHERE
              ws_item_sk = i_item_sk
          and d_date between '2001-03-12' and
                             (cast('2001-03-12' as date) + INTERVAL '90 days')
          and d_date_sk = ws_sold_date_sk
      )
order by sum(ws_ext_discount_amt)
limit 100;
select  ss_customer_sk
            ,sum(act_sales) sumsales
      from (select ss_item_sk
                  ,ss_ticket_number
                  ,ss_customer_sk
                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price
                                                            else (ss_quantity*ss_sales_price) end act_sales
            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk
                                                               and sr_ticket_number = ss_ticket_number)
                ,reason
            where sr_reason_sk = r_reason_sk
              and r_reason_desc = 'reason 66') t
      group by ss_customer_sk
      order by sumsales, ss_customer_sk
limit 100;
select
   count(distinct ws_order_number) as "order count"
  ,sum(ws_ext_ship_cost) as "total shipping cost"
  ,sum(ws_net_profit) as "total net profit"
from
   web_sales ws1
  ,date_dim
  ,customer_address
  ,web_site
where
    d_date between '1999-4-01' and
           (cast('1999-4-01' as date) + INTERVAL '60 days')
and ws1.ws_ship_date_sk = d_date_sk
and ws1.ws_ship_addr_sk = ca_address_sk
and ca_state = 'NE'
and ws1.ws_web_site_sk = web_site_sk
and web_company_name = 'pri'
and exists (select *
            from web_sales ws2
            where ws1.ws_order_number = ws2.ws_order_number
              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)
and not exists(select *
               from web_returns wr1
               where ws1.ws_order_number = wr1.wr_order_number)
order by count(distinct ws_order_number)
limit 100;
with ws_wh as
(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2
 from web_sales ws1,web_sales ws2
 where ws1.ws_order_number = ws2.ws_order_number
   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)
 select
   count(distinct ws_order_number) as "order count"
  ,sum(ws_ext_ship_cost) as "total shipping cost"
  ,sum(ws_net_profit) as "total net profit"
from
   web_sales ws1
  ,date_dim
  ,customer_address
  ,web_site
where
    d_date between '2002-4-01' and
           (cast('2002-4-01' as date) + INTERVAL '60 days')
and ws1.ws_ship_date_sk = d_date_sk
and ws1.ws_ship_addr_sk = ca_address_sk
and ca_state = 'AL'
and ws1.ws_web_site_sk = web_site_sk
and web_company_name = 'pri'
and ws1.ws_order_number in (select ws_order_number
                            from ws_wh)
and ws1.ws_order_number in (select wr_order_number
                            from web_returns,ws_wh
                            where wr_order_number = ws_wh.ws_order_number)
order by count(distinct ws_order_number)
limit 100;
select  count(*)
from store_sales
    ,household_demographics
    ,time_dim, store
where ss_sold_time_sk = time_dim.t_time_sk
    and ss_hdemo_sk = household_demographics.hd_demo_sk
    and ss_store_sk = s_store_sk
    and time_dim.t_hour = 16
    and time_dim.t_minute >= 30
    and household_demographics.hd_dep_count = 6
    and store.s_store_name = 'ese'
order by count(*)
limit 100;
with ssci as (
select ss_customer_sk customer_sk
      ,ss_item_sk item_sk
from store_sales,date_dim
where ss_sold_date_sk = d_date_sk
  and d_month_seq between 1190 and 1190 + 11
group by ss_customer_sk
        ,ss_item_sk),
csci as(
 select cs_bill_customer_sk customer_sk
      ,cs_item_sk item_sk
from catalog_sales,date_dim
where cs_sold_date_sk = d_date_sk
  and d_month_seq between 1190 and 1190 + 11
group by cs_bill_customer_sk
        ,cs_item_sk)
 select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only
      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only
      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog
from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk
                               and ssci.item_sk = csci.item_sk)
limit 100;
select i_item_id
      ,i_item_desc
      ,i_category
      ,i_class
      ,i_current_price
      ,sum(ss_ext_sales_price) as itemrevenue
      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over
          (partition by i_class) as revenueratio
from
	store_sales
    	,item
    	,date_dim
where
	ss_item_sk = i_item_sk
  	and i_category in ('Home', 'Sports', 'Men')
  	and ss_sold_date_sk = d_date_sk
	and d_date between cast('2002-01-05' as date)
				and (cast('2002-01-05' as date) + INTERVAL '30 days')
group by
	i_item_id
        ,i_item_desc
        ,i_category
        ,i_class
        ,i_current_price
order by
	i_category
        ,i_class
        ,i_item_id
        ,i_item_desc
        ,revenueratio;
select
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,cc_name
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as "30 days"
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as "31-60 days"
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as "61-90 days"
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and
                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as "91-120 days"
  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as ">120 days"
from
   catalog_sales
  ,warehouse
  ,ship_mode
  ,call_center
  ,date_dim
where
    d_month_seq between 1178 and 1178 + 11
and cs_ship_date_sk   = d_date_sk
and cs_warehouse_sk   = w_warehouse_sk
and cs_ship_mode_sk   = sm_ship_mode_sk
and cs_call_center_sk = cc_call_center_sk
group by
   substr(w_warehouse_name,1,20)
  ,sm_type
  ,cc_name
order by substr(w_warehouse_name,1,20)
        ,sm_type
        ,cc_name
limit 100;
